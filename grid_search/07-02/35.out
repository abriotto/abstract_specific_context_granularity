# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7019909620285034, "acc": 0.5140402913093567, "length": 3.3599979877471924, "mode": "train", "epoch": 1}
{"loss": 0.688014805316925, "acc": 0.5380547046661377, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6901296377182007, "acc": 0.5472184419631958, "length": 2.1309196949005127, "mode": "train", "epoch": 2}
{"loss": 0.6887409090995789, "acc": 0.538905143737793, "length": 1.0614334344863892, "mode": "test", "epoch": 2}
{"loss": 0.6338602900505066, "acc": 0.6766107082366943, "length": 2.5603721141815186, "mode": "train", "epoch": 3}
{"loss": 0.5624592304229736, "acc": 0.7424781322479248, "length": 3.1911263465881348, "mode": "test", "epoch": 3}
{"loss": 0.5291449427604675, "acc": 0.7676834464073181, "length": 3.144120454788208, "mode": "train", "epoch": 4}
{"loss": 0.5131420493125916, "acc": 0.7634172439575195, "length": 3.3515357971191406, "mode": "test", "epoch": 4}
{"loss": 0.47842273116111755, "acc": 0.7828496098518372, "length": 3.2340197563171387, "mode": "train", "epoch": 5}
{"loss": 0.4898071885108948, "acc": 0.7820037603378296, "length": 3.450511932373047, "mode": "test", "epoch": 5}
{"loss": 0.44313907623291016, "acc": 0.8115383386611938, "length": 3.3128395080566406, "mode": "train", "epoch": 6}
{"loss": 0.4417709410190582, "acc": 0.8081610798835754, "length": 3.3583617210388184, "mode": "test", "epoch": 6}
{"loss": 0.4157485365867615, "acc": 0.8292316198348999, "length": 3.2766807079315186, "mode": "train", "epoch": 7}
{"loss": 0.41968846321105957, "acc": 0.828809380531311, "length": 3.3003413677215576, "mode": "test", "epoch": 7}
{"loss": 0.389191210269928, "acc": 0.8429962992668152, "length": 3.279283285140991, "mode": "train", "epoch": 8}
{"loss": 0.42617565393447876, "acc": 0.8289532661437988, "length": 3.344709873199463, "mode": "test", "epoch": 8}
{"loss": 0.3762737214565277, "acc": 0.8437163829803467, "length": 3.3191771507263184, "mode": "train", "epoch": 9}
{"loss": 0.4247834384441376, "acc": 0.8312309980392456, "length": 3.341296911239624, "mode": "test", "epoch": 9}
{"loss": 0.37015894055366516, "acc": 0.8444029688835144, "length": 3.349090576171875, "mode": "train", "epoch": 10}
{"loss": 0.4088113009929657, "acc": 0.8344640731811523, "length": 3.26621150970459, "mode": "test", "epoch": 10}
{"loss": 0.3592543303966522, "acc": 0.8485842943191528, "length": 3.318614959716797, "mode": "train", "epoch": 11}
{"loss": 0.3843626081943512, "acc": 0.833397388458252, "length": 3.232081890106201, "mode": "test", "epoch": 11}
{"loss": 0.3493225872516632, "acc": 0.8507463335990906, "length": 3.329115152359009, "mode": "train", "epoch": 12}
{"loss": 0.3907533884048462, "acc": 0.838132381439209, "length": 3.2832765579223633, "mode": "test", "epoch": 12}
{"loss": 0.34333428740501404, "acc": 0.8508932590484619, "length": 3.4335999488830566, "mode": "train", "epoch": 13}
{"loss": 0.3876863420009613, "acc": 0.8296086192131042, "length": 3.4914674758911133, "mode": "test", "epoch": 13}
{"loss": 0.32866987586021423, "acc": 0.859119176864624, "length": 3.552412748336792, "mode": "train", "epoch": 14}
{"loss": 0.35214924812316895, "acc": 0.8463030457496643, "length": 3.5938565731048584, "mode": "test", "epoch": 14}
{"loss": 0.31397098302841187, "acc": 0.8647369146347046, "length": 3.6178340911865234, "mode": "train", "epoch": 15}
{"loss": 0.35639050602912903, "acc": 0.8564001321792603, "length": 3.6416382789611816, "mode": "test", "epoch": 15}
{"loss": 0.29598915576934814, "acc": 0.8713507652282715, "length": 3.6910624504089355, "mode": "train", "epoch": 16}
{"loss": 0.3588658273220062, "acc": 0.8586271405220032, "length": 3.7508533000946045, "mode": "test", "epoch": 16}
{"loss": 0.28058427572250366, "acc": 0.8833715319633484, "length": 3.732895851135254, "mode": "train", "epoch": 17}
{"loss": 0.3274374008178711, "acc": 0.8678099513053894, "length": 3.682593822479248, "mode": "test", "epoch": 17}
{"loss": 0.2628944516181946, "acc": 0.8906038403511047, "length": 3.7537710666656494, "mode": "train", "epoch": 18}
{"loss": 0.3111024498939514, "acc": 0.881608784198761, "length": 3.8088736534118652, "mode": "test", "epoch": 18}
{"loss": 0.24256481230258942, "acc": 0.9009152054786682, "length": 3.816418170928955, "mode": "train", "epoch": 19}
{"loss": 0.30172663927078247, "acc": 0.8763729929924011, "length": 3.839590549468994, "mode": "test", "epoch": 19}
{"loss": 0.2331041395664215, "acc": 0.9043119549751282, "length": 3.838258743286133, "mode": "train", "epoch": 20}
{"loss": 0.2852432429790497, "acc": 0.8880096673965454, "length": 3.9010238647460938, "mode": "test", "epoch": 20}
{"loss": 0.22414769232273102, "acc": 0.911087155342102, "length": 3.885693073272705, "mode": "train", "epoch": 21}
{"loss": 0.27526581287384033, "acc": 0.88790363073349, "length": 3.9078497886657715, "mode": "test", "epoch": 21}
{"loss": 0.21613921225070953, "acc": 0.9158342480659485, "length": 3.856062173843384, "mode": "train", "epoch": 22}
{"loss": 0.2743088901042938, "acc": 0.8987892270088196, "length": 3.8566553592681885, "mode": "test", "epoch": 22}
{"loss": 0.2023148238658905, "acc": 0.9217168688774109, "length": 3.864788293838501, "mode": "train", "epoch": 23}
{"loss": 0.2589004337787628, "acc": 0.9012832641601562, "length": 3.9010238647460938, "mode": "test", "epoch": 23}
{"loss": 0.1931290477514267, "acc": 0.9268285036087036, "length": 3.8501946926116943, "mode": "train", "epoch": 24}
{"loss": 0.25192293524742126, "acc": 0.9095155596733093, "length": 3.8020477294921875, "mode": "test", "epoch": 24}
{"loss": 0.19268698990345, "acc": 0.9269537925720215, "length": 3.8517861366271973, "mode": "train", "epoch": 25}
{"loss": 0.24494171142578125, "acc": 0.9072626829147339, "length": 3.8771331310272217, "mode": "test", "epoch": 25}
{"loss": 0.18852940201759338, "acc": 0.9280797839164734, "length": 3.8648760318756104, "mode": "train", "epoch": 26}
{"loss": 0.22816848754882812, "acc": 0.9115573763847351, "length": 3.8225255012512207, "mode": "test", "epoch": 26}
{"loss": 0.17246998846530914, "acc": 0.9368446469306946, "length": 3.829407215118408, "mode": "train", "epoch": 27}
{"loss": 0.22287192940711975, "acc": 0.9209290742874146, "length": 3.8498294353485107, "mode": "test", "epoch": 27}
{"loss": 0.1577211320400238, "acc": 0.9424402117729187, "length": 3.8479580879211426, "mode": "train", "epoch": 28}
{"loss": 0.2204200029373169, "acc": 0.9188565611839294, "length": 3.843003511428833, "mode": "test", "epoch": 28}
{"loss": 0.15665879845619202, "acc": 0.940356969833374, "length": 3.800299644470215, "mode": "train", "epoch": 29}
{"loss": 0.20583371818065643, "acc": 0.9169850945472717, "length": 3.8361775875091553, "mode": "test", "epoch": 29}
{"loss": 0.15390869975090027, "acc": 0.9431620836257935, "length": 3.8373312950134277, "mode": "train", "epoch": 30}
{"loss": 0.21013610064983368, "acc": 0.9244221448898315, "length": 3.8088736534118652, "mode": "test", "epoch": 30}
{"loss": 0.15187077224254608, "acc": 0.9446746706962585, "length": 3.8360438346862793, "mode": "train", "epoch": 31}
{"loss": 0.20103763043880463, "acc": 0.9271308779716492, "length": 3.8259384632110596, "mode": "test", "epoch": 31}
{"loss": 0.1409163475036621, "acc": 0.9485771656036377, "length": 3.767230987548828, "mode": "train", "epoch": 32}
{"loss": 0.21317486464977264, "acc": 0.9282357692718506, "length": 3.7747440338134766, "mode": "test", "epoch": 32}
{"loss": 0.13972221314907074, "acc": 0.9494066834449768, "length": 3.8368594646453857, "mode": "train", "epoch": 33}
{"loss": 0.19359400868415833, "acc": 0.9305205345153809, "length": 3.7713310718536377, "mode": "test", "epoch": 33}
{"loss": 0.13741730153560638, "acc": 0.9529586434364319, "length": 3.7597334384918213, "mode": "train", "epoch": 34}
{"loss": 0.20709657669067383, "acc": 0.9325703978538513, "length": 3.8327643871307373, "mode": "test", "epoch": 34}
{"loss": 0.13174104690551758, "acc": 0.9548085927963257, "length": 3.799717664718628, "mode": "train", "epoch": 35}
{"loss": 0.20528653264045715, "acc": 0.9357879757881165, "length": 3.7474403381347656, "mode": "test", "epoch": 35}
{"loss": 0.12945476174354553, "acc": 0.9533800482749939, "length": 3.7704856395721436, "mode": "train", "epoch": 36}
{"loss": 0.1835791915655136, "acc": 0.940464973449707, "length": 3.761092185974121, "mode": "test", "epoch": 36}
{"loss": 0.12634161114692688, "acc": 0.9560129046440125, "length": 3.8123619556427, "mode": "train", "epoch": 37}
{"loss": 0.17106129229068756, "acc": 0.9442787766456604, "length": 3.819112539291382, "mode": "test", "epoch": 37}
{"loss": 0.1215297058224678, "acc": 0.9585208296775818, "length": 3.8206868171691895, "mode": "train", "epoch": 38}
{"loss": 0.17748896777629852, "acc": 0.9436196684837341, "length": 3.740614414215088, "mode": "test", "epoch": 38}
{"loss": 0.11534172296524048, "acc": 0.9590682983398438, "length": 3.7471277713775635, "mode": "train", "epoch": 39}
{"loss": 0.17457203567028046, "acc": 0.9414910078048706, "length": 3.7474403381347656, "mode": "test", "epoch": 39}
{"loss": 0.11716601252555847, "acc": 0.9588502645492554, "length": 3.7491629123687744, "mode": "train", "epoch": 40}
{"loss": 0.17310285568237305, "acc": 0.9499382376670837, "length": 3.7474403381347656, "mode": "test", "epoch": 40}
{"loss": 0.10802452266216278, "acc": 0.963157057762146, "length": 3.7934935092926025, "mode": "train", "epoch": 41}
{"loss": 0.1532488316297531, "acc": 0.9549424052238464, "length": 3.7508533000946045, "mode": "test", "epoch": 41}
{"loss": 0.10181903094053268, "acc": 0.9648159146308899, "length": 3.7540175914764404, "mode": "train", "epoch": 42}
{"loss": 0.14620612561702728, "acc": 0.9528840780258179, "length": 3.682593822479248, "mode": "test", "epoch": 42}
{"loss": 0.09947273135185242, "acc": 0.9660581946372986, "length": 3.7366085052490234, "mode": "train", "epoch": 43}
{"loss": 0.14312374591827393, "acc": 0.9570311307907104, "length": 3.7508533000946045, "mode": "test", "epoch": 43}
{"loss": 0.0955333560705185, "acc": 0.9689002633094788, "length": 3.766810655593872, "mode": "train", "epoch": 44}
{"loss": 0.15199032425880432, "acc": 0.9521602988243103, "length": 3.7201364040374756, "mode": "test", "epoch": 44}
{"loss": 0.10106532275676727, "acc": 0.9646349549293518, "length": 3.7272346019744873, "mode": "train", "epoch": 45}
{"loss": 0.1549997180700302, "acc": 0.954473078250885, "length": 3.6996586322784424, "mode": "test", "epoch": 45}
{"loss": 0.08448304980993271, "acc": 0.970421552658081, "length": 3.7901904582977295, "mode": "train", "epoch": 46}
{"loss": 0.1257748007774353, "acc": 0.9633407592773438, "length": 3.7474403381347656, "mode": "test", "epoch": 46}
{"loss": 0.08252695202827454, "acc": 0.973908007144928, "length": 3.7580955028533936, "mode": "train", "epoch": 47}
{"loss": 0.12931625545024872, "acc": 0.9646865725517273, "length": 3.740614414215088, "mode": "test", "epoch": 47}
{"loss": 0.08033297955989838, "acc": 0.9732456803321838, "length": 3.7797017097473145, "mode": "train", "epoch": 48}
{"loss": 0.13146960735321045, "acc": 0.9601501822471619, "length": 3.7235496044158936, "mode": "test", "epoch": 48}
{"loss": 0.07884936034679413, "acc": 0.9723931550979614, "length": 3.763218641281128, "mode": "train", "epoch": 49}
{"loss": 0.1336035579442978, "acc": 0.9616448283195496, "length": 3.812286615371704, "mode": "test", "epoch": 49}
{"loss": 0.07617441564798355, "acc": 0.9712790846824646, "length": 3.7860398292541504, "mode": "train", "epoch": 50}
{"loss": 0.1400936096906662, "acc": 0.9556755423545837, "length": 3.7713310718536377, "mode": "test", "epoch": 50}
{"loss": 0.07573387771844864, "acc": 0.9736860394477844, "length": 3.761817693710327, "mode": "train", "epoch": 51}
{"loss": 0.13967785239219666, "acc": 0.9586693048477173, "length": 3.7815699577331543, "mode": "test", "epoch": 51}
{"loss": 0.07334449142217636, "acc": 0.9747754335403442, "length": 3.78074049949646, "mode": "train", "epoch": 52}
{"loss": 0.13857251405715942, "acc": 0.9641498923301697, "length": 3.791808843612671, "mode": "test", "epoch": 52}
{"loss": 0.06618303805589676, "acc": 0.9786034822463989, "length": 3.772812843322754, "mode": "train", "epoch": 53}
{"loss": 0.13709668815135956, "acc": 0.9638508558273315, "length": 3.740614414215088, "mode": "test", "epoch": 53}
{"loss": 0.06190430372953415, "acc": 0.97812819480896, "length": 3.7848219871520996, "mode": "train", "epoch": 54}
{"loss": 0.14675550162792206, "acc": 0.96247798204422, "length": 3.7986347675323486, "mode": "test", "epoch": 54}
{"loss": 0.05923748388886452, "acc": 0.9812895655632019, "length": 3.8028438091278076, "mode": "train", "epoch": 55}
{"loss": 0.12380236387252808, "acc": 0.9636539816856384, "length": 3.8054606914520264, "mode": "test", "epoch": 55}
{"loss": 0.054952364414930344, "acc": 0.9810171127319336, "length": 3.8047733306884766, "mode": "train", "epoch": 56}
{"loss": 0.10793165117502213, "acc": 0.9701469540596008, "length": 3.8293514251708984, "mode": "test", "epoch": 56}
{"loss": 0.054015107452869415, "acc": 0.9806340932846069, "length": 3.83225417137146, "mode": "train", "epoch": 57}
{"loss": 0.10940412431955338, "acc": 0.9637191891670227, "length": 3.839590549468994, "mode": "test", "epoch": 57}
{"loss": 0.0560510978102684, "acc": 0.9805535674095154, "length": 3.821659564971924, "mode": "train", "epoch": 58}
{"loss": 0.10846038162708282, "acc": 0.9712563157081604, "length": 3.7474403381347656, "mode": "test", "epoch": 58}
{"loss": 0.0662619024515152, "acc": 0.976557195186615, "length": 3.7821662425994873, "mode": "train", "epoch": 59}
{"loss": 0.13745246827602386, "acc": 0.9609445929527283, "length": 3.8088736534118652, "mode": "test", "epoch": 59}
{"loss": 0.06635764986276627, "acc": 0.9764949679374695, "length": 3.7983388900756836, "mode": "train", "epoch": 60}
{"loss": 0.161040261387825, "acc": 0.9569034576416016, "length": 3.7815699577331543, "mode": "test", "epoch": 60}
test accuracy: 0.8129050731658936
