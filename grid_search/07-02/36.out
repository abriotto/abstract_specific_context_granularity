# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6935327649116516, "acc": 0.525317907333374, "length": 3.47737455368042, "mode": "train", "epoch": 1}
{"loss": 0.6891575455665588, "acc": 0.5506944060325623, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6862229108810425, "acc": 0.5546969771385193, "length": 3.0220513343811035, "mode": "train", "epoch": 2}
{"loss": 0.659728467464447, "acc": 0.6645779013633728, "length": 2.21875, "mode": "test", "epoch": 2}
{"loss": 0.636030912399292, "acc": 0.6711535453796387, "length": 3.282285451889038, "mode": "train", "epoch": 3}
{"loss": 0.5517184734344482, "acc": 0.7807780504226685, "length": 3.7326388359069824, "mode": "test", "epoch": 3}
{"loss": 0.5099742412567139, "acc": 0.7724031805992126, "length": 3.7784194946289062, "mode": "train", "epoch": 4}
{"loss": 0.4958689212799072, "acc": 0.7828124165534973, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.45469027757644653, "acc": 0.79465252161026, "length": 3.9375922679901123, "mode": "train", "epoch": 5}
{"loss": 0.4651308059692383, "acc": 0.8026041984558105, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.42424672842025757, "acc": 0.8101546168327332, "length": 3.965949296951294, "mode": "train", "epoch": 6}
{"loss": 0.44451817870140076, "acc": 0.8111110925674438, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.40380769968032837, "acc": 0.8221638202667236, "length": 3.975149393081665, "mode": "train", "epoch": 7}
{"loss": 0.4442899227142334, "acc": 0.8133680820465088, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3844657242298126, "acc": 0.8331528902053833, "length": 3.98099684715271, "mode": "train", "epoch": 8}
{"loss": 0.41334182024002075, "acc": 0.8317708969116211, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.34776952862739563, "acc": 0.8525868654251099, "length": 3.9876041412353516, "mode": "train", "epoch": 9}
{"loss": 0.3982870280742645, "acc": 0.8440971970558167, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.3261343538761139, "acc": 0.8649767637252808, "length": 3.992203712463379, "mode": "train", "epoch": 10}
{"loss": 0.3882533013820648, "acc": 0.8465278744697571, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.3037428855895996, "acc": 0.8703808784484863, "length": 3.99345326423645, "mode": "train", "epoch": 11}
{"loss": 0.35935109853744507, "acc": 0.8638889789581299, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2852014899253845, "acc": 0.883816659450531, "length": 3.9941904544830322, "mode": "train", "epoch": 12}
{"loss": 0.33730968832969666, "acc": 0.8690973520278931, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.2728049159049988, "acc": 0.8913016319274902, "length": 3.994542121887207, "mode": "train", "epoch": 13}
{"loss": 0.32128819823265076, "acc": 0.8819444179534912, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.2562881112098694, "acc": 0.9008899331092834, "length": 3.997358560562134, "mode": "train", "epoch": 14}
{"loss": 0.29170575737953186, "acc": 0.8939235210418701, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.24458861351013184, "acc": 0.9095956683158875, "length": 3.9981272220611572, "mode": "train", "epoch": 15}
{"loss": 0.3078547418117523, "acc": 0.8878471851348877, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.23550792038440704, "acc": 0.9112232327461243, "length": 3.998349905014038, "mode": "train", "epoch": 16}
{"loss": 0.29286065697669983, "acc": 0.8852429986000061, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.22734107077121735, "acc": 0.9129704236984253, "length": 3.9975218772888184, "mode": "train", "epoch": 17}
{"loss": 0.28522706031799316, "acc": 0.8982638120651245, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2076694220304489, "acc": 0.9209215641021729, "length": 3.999068021774292, "mode": "train", "epoch": 18}
{"loss": 0.2626550495624542, "acc": 0.9032986164093018, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.20342309772968292, "acc": 0.9240519404411316, "length": 3.9990670680999756, "mode": "train", "epoch": 19}
{"loss": 0.26033851504325867, "acc": 0.9034721851348877, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.20017430186271667, "acc": 0.9277758002281189, "length": 3.9996559619903564, "mode": "train", "epoch": 20}
{"loss": 0.23340080678462982, "acc": 0.9098958969116211, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.18923765420913696, "acc": 0.9334595799446106, "length": 3.99949312210083, "mode": "train", "epoch": 21}
{"loss": 0.23587821424007416, "acc": 0.9130207896232605, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.18108801543712616, "acc": 0.937227725982666, "length": 3.9995031356811523, "mode": "train", "epoch": 22}
{"loss": 0.2430451214313507, "acc": 0.9149305820465088, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.17460349202156067, "acc": 0.9391264915466309, "length": 3.9993019104003906, "mode": "train", "epoch": 23}
{"loss": 0.20379029214382172, "acc": 0.9237847924232483, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.17895275354385376, "acc": 0.9355440139770508, "length": 3.9990880489349365, "mode": "train", "epoch": 24}
{"loss": 0.2140265554189682, "acc": 0.9269096851348877, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1712654083967209, "acc": 0.9382779002189636, "length": 3.9997398853302, "mode": "train", "epoch": 25}
{"loss": 0.21396532654762268, "acc": 0.9293402433395386, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.16198109090328217, "acc": 0.9378713369369507, "length": 3.999587059020996, "mode": "train", "epoch": 26}
{"loss": 0.20304398238658905, "acc": 0.9274304509162903, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.15556222200393677, "acc": 0.9452059864997864, "length": 3.9992642402648926, "mode": "train", "epoch": 27}
{"loss": 0.21076320111751556, "acc": 0.925694465637207, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.15351340174674988, "acc": 0.9459876418113708, "length": 3.9995031356811523, "mode": "train", "epoch": 28}
{"loss": 0.168163001537323, "acc": 0.9435763955116272, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.15526437759399414, "acc": 0.9414510130882263, "length": 3.9983773231506348, "mode": "train", "epoch": 29}
{"loss": 0.1673956662416458, "acc": 0.941493034362793, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.15882918238639832, "acc": 0.9456853866577148, "length": 3.9988017082214355, "mode": "train", "epoch": 30}
{"loss": 0.18138568103313446, "acc": 0.9401042461395264, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.14591486752033234, "acc": 0.947154700756073, "length": 3.9998278617858887, "mode": "train", "epoch": 31}
{"loss": 0.16458559036254883, "acc": 0.9465277791023254, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.13844025135040283, "acc": 0.9516767263412476, "length": 3.999812602996826, "mode": "train", "epoch": 32}
{"loss": 0.1616629809141159, "acc": 0.9428820013999939, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.14031526446342468, "acc": 0.9523754715919495, "length": 3.999131679534912, "mode": "train", "epoch": 33}
{"loss": 0.1573745161294937, "acc": 0.9390624165534973, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1363316774368286, "acc": 0.9518556594848633, "length": 3.9999732971191406, "mode": "train", "epoch": 34}
{"loss": 0.1566241979598999, "acc": 0.9503471851348877, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.13140785694122314, "acc": 0.9511014819145203, "length": 3.999969244003296, "mode": "train", "epoch": 35}
{"loss": 0.16567935049533844, "acc": 0.9454861879348755, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.12992823123931885, "acc": 0.9531897902488708, "length": 3.9999749660491943, "mode": "train", "epoch": 36}
{"loss": 0.15029536187648773, "acc": 0.9522568583488464, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.12892702221870422, "acc": 0.9540020227432251, "length": 3.9999866485595703, "mode": "train", "epoch": 37}
{"loss": 0.16960445046424866, "acc": 0.9434027075767517, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.1206887811422348, "acc": 0.9556841850280762, "length": 3.999988317489624, "mode": "train", "epoch": 38}
{"loss": 0.14400389790534973, "acc": 0.9458333253860474, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.12485702335834503, "acc": 0.9544075727462769, "length": 3.9999749660491943, "mode": "train", "epoch": 39}
{"loss": 0.18631266057491302, "acc": 0.9432292580604553, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.12693391740322113, "acc": 0.9505215883255005, "length": 3.999948501586914, "mode": "train", "epoch": 40}
{"loss": 0.14933770895004272, "acc": 0.949305534362793, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.12700018286705017, "acc": 0.953189492225647, "length": 3.9999406337738037, "mode": "train", "epoch": 41}
{"loss": 0.16096456348896027, "acc": 0.9437500834465027, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.13484619557857513, "acc": 0.9493606686592102, "length": 3.999953508377075, "mode": "train", "epoch": 42}
{"loss": 0.17142800986766815, "acc": 0.9411458969116211, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.14691343903541565, "acc": 0.9449535012245178, "length": 3.9999935626983643, "mode": "train", "epoch": 43}
{"loss": 0.15177945792675018, "acc": 0.9458334445953369, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.11559061706066132, "acc": 0.9580277800559998, "length": 3.9978060722351074, "mode": "train", "epoch": 44}
{"loss": 0.14621953666210175, "acc": 0.940972089767456, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.11089345067739487, "acc": 0.9578606486320496, "length": 3.9985456466674805, "mode": "train", "epoch": 45}
{"loss": 0.14966392517089844, "acc": 0.9447916746139526, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.10620937496423721, "acc": 0.9631084203720093, "length": 3.999979019165039, "mode": "train", "epoch": 46}
{"loss": 0.14890676736831665, "acc": 0.9552082419395447, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.11350599676370621, "acc": 0.9557409882545471, "length": 3.9999303817749023, "mode": "train", "epoch": 47}
{"loss": 0.150125190615654, "acc": 0.9467013478279114, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.10792876780033112, "acc": 0.958352267742157, "length": 3.999978542327881, "mode": "train", "epoch": 48}
{"loss": 0.13845890760421753, "acc": 0.9538193941116333, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.10909807682037354, "acc": 0.9574244618415833, "length": 3.9999942779541016, "mode": "train", "epoch": 49}
{"loss": 0.11839962005615234, "acc": 0.9612847566604614, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.10100473463535309, "acc": 0.9651392102241516, "length": 3.9999990463256836, "mode": "train", "epoch": 50}
{"loss": 0.1245342493057251, "acc": 0.9512152075767517, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.10381688177585602, "acc": 0.9612897038459778, "length": 3.9994118213653564, "mode": "train", "epoch": 51}
{"loss": 0.131012961268425, "acc": 0.9493056535720825, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.10967618972063065, "acc": 0.9552201628684998, "length": 3.9999938011169434, "mode": "train", "epoch": 52}
{"loss": 0.11209135502576828, "acc": 0.9590277075767517, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.10205980390310287, "acc": 0.9607875943183899, "length": 3.999927520751953, "mode": "train", "epoch": 53}
{"loss": 0.13856230676174164, "acc": 0.9501733779907227, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.0962873324751854, "acc": 0.9625146389007568, "length": 3.9992928504943848, "mode": "train", "epoch": 54}
{"loss": 0.10542260855436325, "acc": 0.9652777910232544, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.0933239683508873, "acc": 0.9638034701347351, "length": 3.9999020099639893, "mode": "train", "epoch": 55}
{"loss": 0.1115323081612587, "acc": 0.9612847566604614, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.09101215749979019, "acc": 0.961320698261261, "length": 3.998041868209839, "mode": "train", "epoch": 56}
{"loss": 0.1202167496085167, "acc": 0.9598957896232605, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.09151149541139603, "acc": 0.9656010270118713, "length": 3.999927282333374, "mode": "train", "epoch": 57}
{"loss": 0.1381606012582779, "acc": 0.9630208611488342, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.09539760649204254, "acc": 0.9636306762695312, "length": 3.9999847412109375, "mode": "train", "epoch": 58}
{"loss": 0.11294901371002197, "acc": 0.9590277075767517, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.09544122964143753, "acc": 0.9628766179084778, "length": 3.9999828338623047, "mode": "train", "epoch": 59}
{"loss": 0.1403820812702179, "acc": 0.9581596851348877, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.09464319050312042, "acc": 0.9632248282432556, "length": 3.999988317489624, "mode": "train", "epoch": 60}
{"loss": 0.10997427999973297, "acc": 0.9572916030883789, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8003448247909546
