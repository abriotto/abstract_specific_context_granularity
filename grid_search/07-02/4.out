# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6951385736465454, "acc": 0.5065197944641113, "length": 3.0988454818725586, "mode": "train", "epoch": 1}
{"loss": 0.6741204261779785, "acc": 0.5941634774208069, "length": 1.5567010641098022, "mode": "test", "epoch": 1}
{"loss": 0.627509355545044, "acc": 0.6464547514915466, "length": 2.9642016887664795, "mode": "train", "epoch": 2}
{"loss": 0.5771714448928833, "acc": 0.7034167647361755, "length": 3.7353951930999756, "mode": "test", "epoch": 2}
{"loss": 0.5213863253593445, "acc": 0.7518445253372192, "length": 3.732070207595825, "mode": "train", "epoch": 3}
{"loss": 0.5093019604682922, "acc": 0.779725193977356, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.4553854465484619, "acc": 0.7928601503372192, "length": 3.93634295463562, "mode": "train", "epoch": 4}
{"loss": 0.4704882800579071, "acc": 0.805841863155365, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.4130002558231354, "acc": 0.8172136545181274, "length": 3.971125364303589, "mode": "train", "epoch": 5}
{"loss": 0.41717544198036194, "acc": 0.8431271910667419, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.37216025590896606, "acc": 0.8495715856552124, "length": 3.985133171081543, "mode": "train", "epoch": 6}
{"loss": 0.3553928732872009, "acc": 0.8484535813331604, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.3312889039516449, "acc": 0.86765456199646, "length": 3.987236738204956, "mode": "train", "epoch": 7}
{"loss": 0.359566867351532, "acc": 0.8601375222206116, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.3002568483352661, "acc": 0.8825931549072266, "length": 3.993112325668335, "mode": "train", "epoch": 8}
{"loss": 0.33151689171791077, "acc": 0.8694158792495728, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.2838856875896454, "acc": 0.8871872425079346, "length": 3.991697072982788, "mode": "train", "epoch": 9}
{"loss": 0.3218555450439453, "acc": 0.8731957674026489, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.27044224739074707, "acc": 0.8930212259292603, "length": 3.9891157150268555, "mode": "train", "epoch": 10}
{"loss": 0.3249954581260681, "acc": 0.8714777231216431, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.25597262382507324, "acc": 0.9035412669181824, "length": 3.9954071044921875, "mode": "train", "epoch": 11}
{"loss": 0.3275545537471771, "acc": 0.8673540353775024, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.2525329291820526, "acc": 0.8980981111526489, "length": 3.99534273147583, "mode": "train", "epoch": 12}
{"loss": 0.30672532320022583, "acc": 0.8762885928153992, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.23065944015979767, "acc": 0.9101232290267944, "length": 3.9968864917755127, "mode": "train", "epoch": 13}
{"loss": 0.2849680483341217, "acc": 0.8814433217048645, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.21622078120708466, "acc": 0.9151923656463623, "length": 3.9970345497131348, "mode": "train", "epoch": 14}
{"loss": 0.25470811128616333, "acc": 0.8989689946174622, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.20609718561172485, "acc": 0.9163612723350525, "length": 3.991987705230713, "mode": "train", "epoch": 15}
{"loss": 0.256022572517395, "acc": 0.9065291881561279, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.18841294944286346, "acc": 0.9318742752075195, "length": 3.9978630542755127, "mode": "train", "epoch": 16}
{"loss": 0.22054150700569153, "acc": 0.9120274782180786, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2021176666021347, "acc": 0.9254998564720154, "length": 3.9982354640960693, "mode": "train", "epoch": 17}
{"loss": 0.21102586388587952, "acc": 0.9204466342926025, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.19866113364696503, "acc": 0.9262593388557434, "length": 3.998591661453247, "mode": "train", "epoch": 18}
{"loss": 0.24425482749938965, "acc": 0.9164949655532837, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.18210572004318237, "acc": 0.9332274198532104, "length": 3.998969554901123, "mode": "train", "epoch": 19}
{"loss": 0.2039170116186142, "acc": 0.9233677387237549, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.17551633715629578, "acc": 0.93844074010849, "length": 3.9980390071868896, "mode": "train", "epoch": 20}
{"loss": 0.1835356056690216, "acc": 0.9256013035774231, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.16216889023780823, "acc": 0.9429945945739746, "length": 3.9986228942871094, "mode": "train", "epoch": 21}
{"loss": 0.18030236661434174, "acc": 0.9285222887992859, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.16320227086544037, "acc": 0.9457841515541077, "length": 3.9995200634002686, "mode": "train", "epoch": 22}
{"loss": 0.18412397801876068, "acc": 0.9331614971160889, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.15166744589805603, "acc": 0.9460965394973755, "length": 3.9984796047210693, "mode": "train", "epoch": 23}
{"loss": 0.16585777699947357, "acc": 0.9420961737632751, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.1377042979001999, "acc": 0.9515817761421204, "length": 3.999194860458374, "mode": "train", "epoch": 24}
{"loss": 0.15007571876049042, "acc": 0.9512028098106384, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.13407933712005615, "acc": 0.9529866576194763, "length": 3.9998624324798584, "mode": "train", "epoch": 25}
{"loss": 0.160409614443779, "acc": 0.9427834153175354, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.15240220725536346, "acc": 0.9475160837173462, "length": 3.9997012615203857, "mode": "train", "epoch": 26}
{"loss": 0.13797084987163544, "acc": 0.9527491331100464, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1603975147008896, "acc": 0.9415302276611328, "length": 3.9996418952941895, "mode": "train", "epoch": 27}
{"loss": 0.18899166584014893, "acc": 0.9305842518806458, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.15253697335720062, "acc": 0.9452183842658997, "length": 3.9994921684265137, "mode": "train", "epoch": 28}
{"loss": 0.15916839241981506, "acc": 0.9443299770355225, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.12763993442058563, "acc": 0.9517714381217957, "length": 3.9994709491729736, "mode": "train", "epoch": 29}
{"loss": 0.1513788402080536, "acc": 0.9505153894424438, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.12548354268074036, "acc": 0.9560394883155823, "length": 3.999941349029541, "mode": "train", "epoch": 30}
{"loss": 0.15971903502941132, "acc": 0.9496562480926514, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.16204221546649933, "acc": 0.9433245658874512, "length": 3.999943733215332, "mode": "train", "epoch": 31}
{"loss": 0.19717857241630554, "acc": 0.9323024749755859, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.14932465553283691, "acc": 0.9460777640342712, "length": 3.9996848106384277, "mode": "train", "epoch": 32}
{"loss": 0.15692202746868134, "acc": 0.941752552986145, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.13473913073539734, "acc": 0.9500409960746765, "length": 3.998884916305542, "mode": "train", "epoch": 33}
{"loss": 0.1416534185409546, "acc": 0.9510309100151062, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.11517616361379623, "acc": 0.9571306109428406, "length": 3.999856948852539, "mode": "train", "epoch": 34}
{"loss": 0.13475865125656128, "acc": 0.9518900513648987, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.1088334396481514, "acc": 0.9559163451194763, "length": 3.998593807220459, "mode": "train", "epoch": 35}
{"loss": 0.14826670289039612, "acc": 0.9503437280654907, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.10556133836507797, "acc": 0.9599533677101135, "length": 3.999981641769409, "mode": "train", "epoch": 36}
{"loss": 0.16052785515785217, "acc": 0.9503437280654907, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.09534981101751328, "acc": 0.9641274809837341, "length": 3.9989185333251953, "mode": "train", "epoch": 37}
{"loss": 0.12178625911474228, "acc": 0.9584192037582397, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.08732673525810242, "acc": 0.9681239128112793, "length": 3.9999887943267822, "mode": "train", "epoch": 38}
{"loss": 0.11623022705316544, "acc": 0.9680413007736206, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.09271609038114548, "acc": 0.9687547087669373, "length": 3.999863386154175, "mode": "train", "epoch": 39}
{"loss": 0.09909245371818542, "acc": 0.9658076167106628, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.09564795345067978, "acc": 0.9629946947097778, "length": 3.999753713607788, "mode": "train", "epoch": 40}
{"loss": 0.11613426357507706, "acc": 0.9608247876167297, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.09338260442018509, "acc": 0.9654178619384766, "length": 3.999932050704956, "mode": "train", "epoch": 41}
{"loss": 0.16394364833831787, "acc": 0.9524054527282715, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.08773601800203323, "acc": 0.9659321904182434, "length": 3.99977970123291, "mode": "train", "epoch": 42}
{"loss": 0.1325732320547104, "acc": 0.9591064453125, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.0947352722287178, "acc": 0.9666248559951782, "length": 3.9997494220733643, "mode": "train", "epoch": 43}
{"loss": 0.1253209114074707, "acc": 0.9584192037582397, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.09068530052900314, "acc": 0.9678927659988403, "length": 3.9999539852142334, "mode": "train", "epoch": 44}
{"loss": 0.09869294613599777, "acc": 0.9689002633094788, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.08096745610237122, "acc": 0.9708021283149719, "length": 3.99924373626709, "mode": "train", "epoch": 45}
{"loss": 0.1018897071480751, "acc": 0.9649484157562256, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.07203363627195358, "acc": 0.9761214852333069, "length": 3.9999842643737793, "mode": "train", "epoch": 46}
{"loss": 0.09391334652900696, "acc": 0.9658076167106628, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.06639483571052551, "acc": 0.975772500038147, "length": 3.99988055229187, "mode": "train", "epoch": 47}
{"loss": 0.08727040141820908, "acc": 0.9726804494857788, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.05875218287110329, "acc": 0.9796860814094543, "length": 3.9999001026153564, "mode": "train", "epoch": 48}
{"loss": 0.09181953221559525, "acc": 0.9718213677406311, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.05871976539492607, "acc": 0.9805511832237244, "length": 3.9999544620513916, "mode": "train", "epoch": 49}
{"loss": 0.10928574949502945, "acc": 0.9733676910400391, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.05583295226097107, "acc": 0.982620894908905, "length": 3.999894857406616, "mode": "train", "epoch": 50}
{"loss": 0.0925300270318985, "acc": 0.9711340665817261, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.06446349620819092, "acc": 0.9800337553024292, "length": 3.99997615814209, "mode": "train", "epoch": 51}
{"loss": 0.114979088306427, "acc": 0.9594501256942749, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.08049861341714859, "acc": 0.9703695178031921, "length": 3.9989073276519775, "mode": "train", "epoch": 52}
{"loss": 0.10704758018255234, "acc": 0.9634019732475281, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.07909776270389557, "acc": 0.9737032055854797, "length": 3.99994158744812, "mode": "train", "epoch": 53}
{"loss": 0.13326208293437958, "acc": 0.9572165608406067, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.0657963752746582, "acc": 0.979452908039093, "length": 3.999727725982666, "mode": "train", "epoch": 54}
{"loss": 0.11745432764291763, "acc": 0.9656357169151306, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.057308364659547806, "acc": 0.9814725518226624, "length": 3.999986171722412, "mode": "train", "epoch": 55}
{"loss": 0.08479442447423935, "acc": 0.9695876836776733, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.06423748284578323, "acc": 0.9774450659751892, "length": 3.999994993209839, "mode": "train", "epoch": 56}
{"loss": 0.08422484993934631, "acc": 0.9671820402145386, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.0657353401184082, "acc": 0.9756039977073669, "length": 3.9999935626983643, "mode": "train", "epoch": 57}
{"loss": 0.10994677990674973, "acc": 0.9608247876167297, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.06494347751140594, "acc": 0.9787106513977051, "length": 3.999983787536621, "mode": "train", "epoch": 58}
{"loss": 0.07586175203323364, "acc": 0.9728522300720215, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.06315315514802933, "acc": 0.9781833291053772, "length": 3.9997305870056152, "mode": "train", "epoch": 59}
{"loss": 0.09226950258016586, "acc": 0.9721649289131165, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.05254683643579483, "acc": 0.9815860390663147, "length": 3.999950647354126, "mode": "train", "epoch": 60}
{"loss": 0.07215756922960281, "acc": 0.9757732152938843, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8094643354415894
