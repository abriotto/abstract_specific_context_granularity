# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.700268030166626, "acc": 0.5114070177078247, "length": 3.4524338245391846, "mode": "train", "epoch": 1}
{"loss": 0.6840790510177612, "acc": 0.5549469590187073, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6948931813240051, "acc": 0.5210294127464294, "length": 3.131852626800537, "mode": "train", "epoch": 2}
{"loss": 0.6901760101318359, "acc": 0.5404593348503113, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6882063150405884, "acc": 0.5509724020957947, "length": 2.430180311203003, "mode": "train", "epoch": 3}
{"loss": 0.6864337921142578, "acc": 0.5756183862686157, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6758909821510315, "acc": 0.5924436450004578, "length": 2.2413878440856934, "mode": "train", "epoch": 4}
{"loss": 0.6485257148742676, "acc": 0.6795393228530884, "length": 1.5901060104370117, "mode": "test", "epoch": 4}
{"loss": 0.6427826285362244, "acc": 0.689538300037384, "length": 2.435086488723755, "mode": "train", "epoch": 5}
{"loss": 0.6087363958358765, "acc": 0.7277409434318542, "length": 1.8586572408676147, "mode": "test", "epoch": 5}
{"loss": 0.5900129675865173, "acc": 0.7463374733924866, "length": 2.5463173389434814, "mode": "train", "epoch": 6}
{"loss": 0.5514333248138428, "acc": 0.7679028511047363, "length": 2.593639612197876, "mode": "test", "epoch": 6}
{"loss": 0.5290974378585815, "acc": 0.7831182479858398, "length": 2.8571279048919678, "mode": "train", "epoch": 7}
{"loss": 0.5127012729644775, "acc": 0.7845739722251892, "length": 2.985865831375122, "mode": "test", "epoch": 7}
{"loss": 0.4742218554019928, "acc": 0.7932526469230652, "length": 3.1836397647857666, "mode": "train", "epoch": 8}
{"loss": 0.47419214248657227, "acc": 0.7880475521087646, "length": 3.406360387802124, "mode": "test", "epoch": 8}
{"loss": 0.44349709153175354, "acc": 0.8034777641296387, "length": 3.4397261142730713, "mode": "train", "epoch": 9}
{"loss": 0.4557923674583435, "acc": 0.8030587434768677, "length": 3.7208480834960938, "mode": "test", "epoch": 9}
{"loss": 0.4239729046821594, "acc": 0.8087109923362732, "length": 3.627864360809326, "mode": "train", "epoch": 10}
{"loss": 0.4499633312225342, "acc": 0.8062722086906433, "length": 3.664310932159424, "mode": "test", "epoch": 10}
{"loss": 0.4072858691215515, "acc": 0.8216034173965454, "length": 3.604034662246704, "mode": "train", "epoch": 11}
{"loss": 0.4452812075614929, "acc": 0.816476583480835, "length": 3.6607773303985596, "mode": "test", "epoch": 11}
{"loss": 0.39090463519096375, "acc": 0.8233329057693481, "length": 3.678549289703369, "mode": "train", "epoch": 12}
{"loss": 0.40750110149383545, "acc": 0.8214291930198669, "length": 3.8021202087402344, "mode": "test", "epoch": 12}
{"loss": 0.3751436471939087, "acc": 0.8333022594451904, "length": 3.7634153366088867, "mode": "train", "epoch": 13}
{"loss": 0.40290188789367676, "acc": 0.8288794159889221, "length": 3.812720775604248, "mode": "test", "epoch": 13}
{"loss": 0.3626149296760559, "acc": 0.8418318033218384, "length": 3.802537202835083, "mode": "train", "epoch": 14}
{"loss": 0.4061558246612549, "acc": 0.8310633301734924, "length": 3.88692569732666, "mode": "test", "epoch": 14}
{"loss": 0.35132238268852234, "acc": 0.8489383459091187, "length": 3.82047438621521, "mode": "train", "epoch": 15}
{"loss": 0.38403233885765076, "acc": 0.8383018374443054, "length": 3.925795078277588, "mode": "test", "epoch": 15}
{"loss": 0.33944186568260193, "acc": 0.8520159125328064, "length": 3.8551597595214844, "mode": "train", "epoch": 16}
{"loss": 0.4036930203437805, "acc": 0.8293663859367371, "length": 3.9045937061309814, "mode": "test", "epoch": 16}
{"loss": 0.3340778946876526, "acc": 0.8495394587516785, "length": 3.829922676086426, "mode": "train", "epoch": 17}
{"loss": 0.3957999646663666, "acc": 0.8432726263999939, "length": 3.8657243251800537, "mode": "test", "epoch": 17}
{"loss": 0.3244236409664154, "acc": 0.8604121208190918, "length": 3.813694953918457, "mode": "train", "epoch": 18}
{"loss": 0.3691490590572357, "acc": 0.8489201068878174, "length": 3.915194272994995, "mode": "test", "epoch": 18}
{"loss": 0.3203012943267822, "acc": 0.8623523116111755, "length": 3.836428642272949, "mode": "train", "epoch": 19}
{"loss": 0.38171109557151794, "acc": 0.8336583971977234, "length": 3.85512375831604, "mode": "test", "epoch": 19}
{"loss": 0.3132917881011963, "acc": 0.8659412860870361, "length": 3.858293056488037, "mode": "train", "epoch": 20}
{"loss": 0.36997970938682556, "acc": 0.8451034426689148, "length": 3.8727915287017822, "mode": "test", "epoch": 20}
{"loss": 0.31194958090782166, "acc": 0.8683485984802246, "length": 3.8426835536956787, "mode": "train", "epoch": 21}
{"loss": 0.3568422794342041, "acc": 0.8577464818954468, "length": 3.8798587322235107, "mode": "test", "epoch": 21}
{"loss": 0.3026014268398285, "acc": 0.8708053827285767, "length": 3.8649940490722656, "mode": "train", "epoch": 22}
{"loss": 0.3586977422237396, "acc": 0.8522142171859741, "length": 3.88692569732666, "mode": "test", "epoch": 22}
{"loss": 0.30602994561195374, "acc": 0.8684288263320923, "length": 3.8955838680267334, "mode": "train", "epoch": 23}
{"loss": 0.34254026412963867, "acc": 0.8572046756744385, "length": 3.901060104370117, "mode": "test", "epoch": 23}
{"loss": 0.29672956466674805, "acc": 0.870707631111145, "length": 3.8790347576141357, "mode": "train", "epoch": 24}
{"loss": 0.33242905139923096, "acc": 0.8643139004707336, "length": 3.8939929008483887, "mode": "test", "epoch": 24}
{"loss": 0.2907821238040924, "acc": 0.8799551725387573, "length": 3.895922899246216, "mode": "train", "epoch": 25}
{"loss": 0.31051141023635864, "acc": 0.881674587726593, "length": 3.897526502609253, "mode": "test", "epoch": 25}
{"loss": 0.2793460488319397, "acc": 0.8863887190818787, "length": 3.902412176132202, "mode": "train", "epoch": 26}
{"loss": 0.3049941062927246, "acc": 0.8871338963508606, "length": 3.901060104370117, "mode": "test", "epoch": 26}
{"loss": 0.27437639236450195, "acc": 0.882631778717041, "length": 3.9134860038757324, "mode": "train", "epoch": 27}
{"loss": 0.292885422706604, "acc": 0.8801157474517822, "length": 3.9081273078918457, "mode": "test", "epoch": 27}
{"loss": 0.26157277822494507, "acc": 0.8912333250045776, "length": 3.924607515335083, "mode": "train", "epoch": 28}
{"loss": 0.2941400408744812, "acc": 0.8741389513015747, "length": 3.9187278747558594, "mode": "test", "epoch": 28}
{"loss": 0.25667139887809753, "acc": 0.8965200185775757, "length": 3.9334404468536377, "mode": "train", "epoch": 29}
{"loss": 0.26294854283332825, "acc": 0.8900677561759949, "length": 3.939929246902466, "mode": "test", "epoch": 29}
{"loss": 0.24786381423473358, "acc": 0.897446870803833, "length": 3.9353830814361572, "mode": "train", "epoch": 30}
{"loss": 0.28128618001937866, "acc": 0.893360435962677, "length": 3.957597255706787, "mode": "test", "epoch": 30}
{"loss": 0.24497950077056885, "acc": 0.8999279737472534, "length": 3.963773727416992, "mode": "train", "epoch": 31}
{"loss": 0.2970079183578491, "acc": 0.8868727684020996, "length": 3.982332229614258, "mode": "test", "epoch": 31}
{"loss": 0.24320586025714874, "acc": 0.8999747037887573, "length": 3.9644765853881836, "mode": "train", "epoch": 32}
{"loss": 0.25619617104530334, "acc": 0.8931096196174622, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.23094408214092255, "acc": 0.9083714485168457, "length": 3.9729268550872803, "mode": "train", "epoch": 33}
{"loss": 0.2837846875190735, "acc": 0.8959362506866455, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.22925671935081482, "acc": 0.9086365699768066, "length": 3.978757858276367, "mode": "train", "epoch": 34}
{"loss": 0.25097981095314026, "acc": 0.9003533124923706, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.2196548581123352, "acc": 0.9125107526779175, "length": 3.9806933403015137, "mode": "train", "epoch": 35}
{"loss": 0.24845236539840698, "acc": 0.9042403101921082, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.218061625957489, "acc": 0.9161731600761414, "length": 3.985123634338379, "mode": "train", "epoch": 36}
{"loss": 0.23849521577358246, "acc": 0.9051238894462585, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.21064125001430511, "acc": 0.9141749143600464, "length": 3.9827353954315186, "mode": "train", "epoch": 37}
{"loss": 0.23127493262290955, "acc": 0.9072439074516296, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.2056507170200348, "acc": 0.9196748733520508, "length": 3.9909942150115967, "mode": "train", "epoch": 38}
{"loss": 0.23959383368492126, "acc": 0.9037104249000549, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.20263797044754028, "acc": 0.9210177659988403, "length": 3.990171194076538, "mode": "train", "epoch": 39}
{"loss": 0.23274919390678406, "acc": 0.90830397605896, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.19701281189918518, "acc": 0.9238142967224121, "length": 3.993892192840576, "mode": "train", "epoch": 40}
{"loss": 0.2181902974843979, "acc": 0.9090105891227722, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.20610815286636353, "acc": 0.916458785533905, "length": 3.995004892349243, "mode": "train", "epoch": 41}
{"loss": 0.22183972597122192, "acc": 0.9086570143699646, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1928108036518097, "acc": 0.9235829710960388, "length": 3.995661497116089, "mode": "train", "epoch": 42}
{"loss": 0.22659549117088318, "acc": 0.90830397605896, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.19759921729564667, "acc": 0.9207659959793091, "length": 3.990433931350708, "mode": "train", "epoch": 43}
{"loss": 0.23225414752960205, "acc": 0.9100706577301025, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.19673992693424225, "acc": 0.9217956066131592, "length": 3.9973528385162354, "mode": "train", "epoch": 44}
{"loss": 0.21572522819042206, "acc": 0.9095407128334045, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.1981913298368454, "acc": 0.9224519729614258, "length": 3.9978716373443604, "mode": "train", "epoch": 45}
{"loss": 0.2317846715450287, "acc": 0.9019433856010437, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.188856303691864, "acc": 0.9253972172737122, "length": 3.9975171089172363, "mode": "train", "epoch": 46}
{"loss": 0.21554267406463623, "acc": 0.9134275913238525, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1907467097043991, "acc": 0.9246712923049927, "length": 3.9974119663238525, "mode": "train", "epoch": 47}
{"loss": 0.2289806455373764, "acc": 0.9106006622314453, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.19497264921665192, "acc": 0.9221076369285583, "length": 3.996774196624756, "mode": "train", "epoch": 48}
{"loss": 0.2257990539073944, "acc": 0.909363865852356, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.19521299004554749, "acc": 0.9223291873931885, "length": 3.997748374938965, "mode": "train", "epoch": 49}
{"loss": 0.22153544425964355, "acc": 0.9143109321594238, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1964932531118393, "acc": 0.9226880073547363, "length": 3.99772572517395, "mode": "train", "epoch": 50}
{"loss": 0.2354874312877655, "acc": 0.9132509231567383, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.19330459833145142, "acc": 0.9237602353096008, "length": 3.9988129138946533, "mode": "train", "epoch": 51}
{"loss": 0.24005946516990662, "acc": 0.9130740761756897, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.1922726035118103, "acc": 0.9231874942779541, "length": 3.9993093013763428, "mode": "train", "epoch": 52}
{"loss": 0.2168615311384201, "acc": 0.9167845845222473, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.1866181641817093, "acc": 0.925286054611206, "length": 3.9970715045928955, "mode": "train", "epoch": 53}
{"loss": 0.2068018913269043, "acc": 0.9180212616920471, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.18667548894882202, "acc": 0.9265887141227722, "length": 3.998905897140503, "mode": "train", "epoch": 54}
{"loss": 0.21135175228118896, "acc": 0.918021023273468, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.1803993284702301, "acc": 0.9320282340049744, "length": 3.9990317821502686, "mode": "train", "epoch": 55}
{"loss": 0.2223532497882843, "acc": 0.9150176048278809, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.18235822021961212, "acc": 0.9283467531204224, "length": 3.997062921524048, "mode": "train", "epoch": 56}
{"loss": 0.2085709422826767, "acc": 0.9185512661933899, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.18124672770500183, "acc": 0.927903413772583, "length": 3.999399423599243, "mode": "train", "epoch": 57}
{"loss": 0.22223591804504395, "acc": 0.9088338613510132, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.17765352129936218, "acc": 0.9301387667655945, "length": 3.9990060329437256, "mode": "train", "epoch": 58}
{"loss": 0.20513316988945007, "acc": 0.9132508039474487, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.17316918075084686, "acc": 0.9316182732582092, "length": 3.9990015029907227, "mode": "train", "epoch": 59}
{"loss": 0.22654125094413757, "acc": 0.9120139479637146, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.17597408592700958, "acc": 0.929264485836029, "length": 3.999518632888794, "mode": "train", "epoch": 60}
{"loss": 0.21498632431030273, "acc": 0.9181979298591614, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8274193406105042
