# ["--attributes=3", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6963439583778381, "acc": 0.5252123475074768, "length": 3.3585221767425537, "mode": "train", "epoch": 1}
{"loss": 0.6866691708564758, "acc": 0.5341905355453491, "length": 1.1840277910232544, "mode": "test", "epoch": 1}
{"loss": 0.6423075795173645, "acc": 0.6497449278831482, "length": 2.955883264541626, "mode": "train", "epoch": 2}
{"loss": 0.5532840490341187, "acc": 0.7287923693656921, "length": 3.2638888359069824, "mode": "test", "epoch": 2}
{"loss": 0.5121434926986694, "acc": 0.7606321573257446, "length": 3.3371527194976807, "mode": "train", "epoch": 3}
{"loss": 0.47886842489242554, "acc": 0.8091417551040649, "length": 3.315972328186035, "mode": "test", "epoch": 3}
{"loss": 0.4364195168018341, "acc": 0.814812958240509, "length": 3.570951223373413, "mode": "train", "epoch": 4}
{"loss": 0.4220079183578491, "acc": 0.8229220509529114, "length": 3.784722328186035, "mode": "test", "epoch": 4}
{"loss": 0.3808364272117615, "acc": 0.8370576500892639, "length": 3.7122349739074707, "mode": "train", "epoch": 5}
{"loss": 0.37240174412727356, "acc": 0.8420789837837219, "length": 3.569444417953491, "mode": "test", "epoch": 5}
{"loss": 0.3513423502445221, "acc": 0.8549786806106567, "length": 3.726776361465454, "mode": "train", "epoch": 6}
{"loss": 0.3627389967441559, "acc": 0.8507432341575623, "length": 3.753472328186035, "mode": "test", "epoch": 6}
{"loss": 0.31634974479675293, "acc": 0.8700358867645264, "length": 3.76649808883667, "mode": "train", "epoch": 7}
{"loss": 0.3629038631916046, "acc": 0.8555230498313904, "length": 3.71875, "mode": "test", "epoch": 7}
{"loss": 0.28608569502830505, "acc": 0.8869920372962952, "length": 3.749385356903076, "mode": "train", "epoch": 8}
{"loss": 0.3379451334476471, "acc": 0.8526313304901123, "length": 3.7916667461395264, "mode": "test", "epoch": 8}
{"loss": 0.25630706548690796, "acc": 0.8983821868896484, "length": 3.8016819953918457, "mode": "train", "epoch": 9}
{"loss": 0.2968734800815582, "acc": 0.8816026449203491, "length": 3.722222328186035, "mode": "test", "epoch": 9}
{"loss": 0.23136764764785767, "acc": 0.9102857112884521, "length": 3.8115601539611816, "mode": "train", "epoch": 10}
{"loss": 0.3176502287387848, "acc": 0.8674317002296448, "length": 3.8298611640930176, "mode": "test", "epoch": 10}
{"loss": 0.22482040524482727, "acc": 0.9112738370895386, "length": 3.8182179927825928, "mode": "train", "epoch": 11}
{"loss": 0.3033602237701416, "acc": 0.8817762732505798, "length": 3.840277671813965, "mode": "test", "epoch": 11}
{"loss": 0.20471914112567902, "acc": 0.9212676882743835, "length": 3.8220136165618896, "mode": "train", "epoch": 12}
{"loss": 0.2718316614627838, "acc": 0.8916558027267456, "length": 3.84375, "mode": "test", "epoch": 12}
{"loss": 0.1907563954591751, "acc": 0.9255152940750122, "length": 3.8357372283935547, "mode": "train", "epoch": 13}
{"loss": 0.25330260396003723, "acc": 0.906494140625, "length": 3.805555582046509, "mode": "test", "epoch": 13}
{"loss": 0.1819731891155243, "acc": 0.9288060069084167, "length": 3.837759256362915, "mode": "train", "epoch": 14}
{"loss": 0.23970729112625122, "acc": 0.908116340637207, "length": 3.809027671813965, "mode": "test", "epoch": 14}
{"loss": 0.1687169224023819, "acc": 0.9366875886917114, "length": 3.8196511268615723, "mode": "train", "epoch": 15}
{"loss": 0.24308694899082184, "acc": 0.8965983986854553, "length": 3.8333332538604736, "mode": "test", "epoch": 15}
{"loss": 0.1778668463230133, "acc": 0.9288936257362366, "length": 3.8383307456970215, "mode": "train", "epoch": 16}
{"loss": 0.2248436063528061, "acc": 0.9156954884529114, "length": 3.7951388359069824, "mode": "test", "epoch": 16}
{"loss": 0.16230781376361847, "acc": 0.936965823173523, "length": 3.8482844829559326, "mode": "train", "epoch": 17}
{"loss": 0.1877264529466629, "acc": 0.9291884303092957, "length": 3.7951388359069824, "mode": "test", "epoch": 17}
{"loss": 0.1491451859474182, "acc": 0.9456456899642944, "length": 3.850342035293579, "mode": "train", "epoch": 18}
{"loss": 0.21772681176662445, "acc": 0.9213759303092957, "length": 3.8645832538604736, "mode": "test", "epoch": 18}
{"loss": 0.14628008008003235, "acc": 0.9457141757011414, "length": 3.8592255115509033, "mode": "train", "epoch": 19}
{"loss": 0.18938575685024261, "acc": 0.933751106262207, "length": 3.8020832538604736, "mode": "test", "epoch": 19}
{"loss": 0.1311752051115036, "acc": 0.9513654708862305, "length": 3.867778778076172, "mode": "train", "epoch": 20}
{"loss": 0.17916709184646606, "acc": 0.9328559041023254, "length": 3.8125, "mode": "test", "epoch": 20}
{"loss": 0.13934803009033203, "acc": 0.9473325610160828, "length": 3.862887382507324, "mode": "train", "epoch": 21}
{"loss": 0.19657786190509796, "acc": 0.9338324666023254, "length": 3.8125, "mode": "test", "epoch": 21}
{"loss": 0.129735067486763, "acc": 0.9544207453727722, "length": 3.8444676399230957, "mode": "train", "epoch": 22}
{"loss": 0.17446084320545197, "acc": 0.9397677183151245, "length": 3.7673611640930176, "mode": "test", "epoch": 22}
{"loss": 0.11798037588596344, "acc": 0.9561793804168701, "length": 3.8555285930633545, "mode": "train", "epoch": 23}
{"loss": 0.16105669736862183, "acc": 0.9431965947151184, "length": 3.840277671813965, "mode": "test", "epoch": 23}
{"loss": 0.11384643614292145, "acc": 0.9584705233573914, "length": 3.8664822578430176, "mode": "train", "epoch": 24}
{"loss": 0.14404542744159698, "acc": 0.9454644322395325, "length": 3.8263888359069824, "mode": "test", "epoch": 24}
{"loss": 0.11163781583309174, "acc": 0.960035502910614, "length": 3.865557909011841, "mode": "train", "epoch": 25}
{"loss": 0.15019051730632782, "acc": 0.9462999701499939, "length": 3.8229167461395264, "mode": "test", "epoch": 25}
{"loss": 0.10364427417516708, "acc": 0.9629341959953308, "length": 3.852302312850952, "mode": "train", "epoch": 26}
{"loss": 0.15149176120758057, "acc": 0.9479709267616272, "length": 3.8576388359069824, "mode": "test", "epoch": 26}
{"loss": 0.09571844339370728, "acc": 0.9670020937919617, "length": 3.9025700092315674, "mode": "train", "epoch": 27}
{"loss": 0.14615315198898315, "acc": 0.9434082508087158, "length": 3.9236111640930176, "mode": "test", "epoch": 27}
{"loss": 0.09259360283613205, "acc": 0.9666642546653748, "length": 3.9198267459869385, "mode": "train", "epoch": 28}
{"loss": 0.14689111709594727, "acc": 0.9510579705238342, "length": 3.8645832538604736, "mode": "test", "epoch": 28}
{"loss": 0.09038557857275009, "acc": 0.9674558639526367, "length": 3.8935468196868896, "mode": "train", "epoch": 29}
{"loss": 0.13122786581516266, "acc": 0.9543131589889526, "length": 3.8958332538604736, "mode": "test", "epoch": 29}
{"loss": 0.07827948033809662, "acc": 0.9737379550933838, "length": 3.9253334999084473, "mode": "train", "epoch": 30}
{"loss": 0.13273389637470245, "acc": 0.9517253041267395, "length": 3.9166667461395264, "mode": "test", "epoch": 30}
{"loss": 0.07187122106552124, "acc": 0.977095901966095, "length": 3.9323742389678955, "mode": "train", "epoch": 31}
{"loss": 0.12219725549221039, "acc": 0.9590441584587097, "length": 3.9270832538604736, "mode": "test", "epoch": 31}
{"loss": 0.06849826127290726, "acc": 0.9776433110237122, "length": 3.931594133377075, "mode": "train", "epoch": 32}
{"loss": 0.12254314869642258, "acc": 0.9620388746261597, "length": 3.90625, "mode": "test", "epoch": 32}
{"loss": 0.06109694764018059, "acc": 0.9806269407272339, "length": 3.9207420349121094, "mode": "train", "epoch": 33}
{"loss": 0.1104729026556015, "acc": 0.9577311277389526, "length": 3.9270832538604736, "mode": "test", "epoch": 33}
{"loss": 0.05334362015128136, "acc": 0.9828738570213318, "length": 3.948385000228882, "mode": "train", "epoch": 34}
{"loss": 0.10666158050298691, "acc": 0.9631131291389465, "length": 3.9826388359069824, "mode": "test", "epoch": 34}
{"loss": 0.051470797508955, "acc": 0.9823569655418396, "length": 3.9492592811584473, "mode": "train", "epoch": 35}
{"loss": 0.12324532121419907, "acc": 0.9643609523773193, "length": 3.930555582046509, "mode": "test", "epoch": 35}
{"loss": 0.0517093650996685, "acc": 0.9831486344337463, "length": 3.9405078887939453, "mode": "train", "epoch": 36}
{"loss": 0.12458755075931549, "acc": 0.9567436575889587, "length": 3.9583332538604736, "mode": "test", "epoch": 36}
{"loss": 0.04483405500650406, "acc": 0.9878217577934265, "length": 3.9583022594451904, "mode": "train", "epoch": 37}
{"loss": 0.10557225346565247, "acc": 0.9641655683517456, "length": 3.9479167461395264, "mode": "test", "epoch": 37}
{"loss": 0.043462447822093964, "acc": 0.9876360893249512, "length": 3.9572107791900635, "mode": "train", "epoch": 38}
{"loss": 0.13419528305530548, "acc": 0.9624294638633728, "length": 3.9861111640930176, "mode": "test", "epoch": 38}
{"loss": 0.04050292819738388, "acc": 0.988919734954834, "length": 3.9685399532318115, "mode": "train", "epoch": 39}
{"loss": 0.12823481857776642, "acc": 0.9625922441482544, "length": 3.996527671813965, "mode": "test", "epoch": 39}
{"loss": 0.04066336154937744, "acc": 0.9876731038093567, "length": 3.9710726737976074, "mode": "train", "epoch": 40}
{"loss": 0.1073918268084526, "acc": 0.969075620174408, "length": 3.9895832538604736, "mode": "test", "epoch": 40}
{"loss": 0.0416986383497715, "acc": 0.9888535141944885, "length": 3.9699056148529053, "mode": "train", "epoch": 41}
{"loss": 0.1095002219080925, "acc": 0.9700249433517456, "length": 3.9791667461395264, "mode": "test", "epoch": 41}
{"loss": 0.06271620094776154, "acc": 0.9798797369003296, "length": 3.979340076446533, "mode": "train", "epoch": 42}
{"loss": 0.12101667374372482, "acc": 0.9617024660110474, "length": 3.996527671813965, "mode": "test", "epoch": 42}
{"loss": 0.04934379830956459, "acc": 0.985181987285614, "length": 3.9727632999420166, "mode": "train", "epoch": 43}
{"loss": 0.1333046704530716, "acc": 0.9577800035476685, "length": 3.975694417953491, "mode": "test", "epoch": 43}
{"loss": 0.04733369126915932, "acc": 0.9847393035888672, "length": 3.965471029281616, "mode": "train", "epoch": 44}
{"loss": 0.11216568946838379, "acc": 0.9658799767494202, "length": 3.9861111640930176, "mode": "test", "epoch": 44}
{"loss": 0.03649447485804558, "acc": 0.9878875017166138, "length": 3.982105255126953, "mode": "train", "epoch": 45}
{"loss": 0.12957337498664856, "acc": 0.9652941226959229, "length": 3.996527671813965, "mode": "test", "epoch": 45}
{"loss": 0.03647354990243912, "acc": 0.990469753742218, "length": 3.984337091445923, "mode": "train", "epoch": 46}
{"loss": 0.09880939871072769, "acc": 0.9718749523162842, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.024663463234901428, "acc": 0.9942891001701355, "length": 3.9896974563598633, "mode": "train", "epoch": 47}
{"loss": 0.10970703512430191, "acc": 0.9703124165534973, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.035618823021650314, "acc": 0.9899376034736633, "length": 3.9818668365478516, "mode": "train", "epoch": 48}
{"loss": 0.12763723731040955, "acc": 0.9630208611488342, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.03126990422606468, "acc": 0.9911432266235352, "length": 3.9872853755950928, "mode": "train", "epoch": 49}
{"loss": 0.09873375296592712, "acc": 0.9677082896232605, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.03637731820344925, "acc": 0.9886907935142517, "length": 3.9857966899871826, "mode": "train", "epoch": 50}
{"loss": 0.08537668734788895, "acc": 0.9701606035232544, "length": 3.9861111640930176, "mode": "test", "epoch": 50}
{"loss": 0.048760123550891876, "acc": 0.9872851371765137, "length": 3.9870123863220215, "mode": "train", "epoch": 51}
{"loss": 0.1219930499792099, "acc": 0.9644804000854492, "length": 3.9895832538604736, "mode": "test", "epoch": 51}
{"loss": 0.040255106985569, "acc": 0.9873307347297668, "length": 3.982386589050293, "mode": "train", "epoch": 52}
{"loss": 0.0956493467092514, "acc": 0.9711804986000061, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.024498233571648598, "acc": 0.9955874681472778, "length": 3.989670515060425, "mode": "train", "epoch": 53}
{"loss": 0.07485856860876083, "acc": 0.9725697040557861, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.02206994593143463, "acc": 0.994704008102417, "length": 3.99458646774292, "mode": "train", "epoch": 54}
{"loss": 0.08722446113824844, "acc": 0.9717013835906982, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.030658461153507233, "acc": 0.9915798306465149, "length": 3.9963741302490234, "mode": "train", "epoch": 55}
{"loss": 0.08358891308307648, "acc": 0.9748263955116272, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.019627941772341728, "acc": 0.9947431683540344, "length": 3.9970290660858154, "mode": "train", "epoch": 56}
{"loss": 0.08313819020986557, "acc": 0.9744792580604553, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.020354660227894783, "acc": 0.9949332475662231, "length": 3.9981563091278076, "mode": "train", "epoch": 57}
{"loss": 0.07496092468500137, "acc": 0.9765625, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.016367532312870026, "acc": 0.996902346611023, "length": 3.99825382232666, "mode": "train", "epoch": 58}
{"loss": 0.0639689713716507, "acc": 0.9784722924232483, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.012036515399813652, "acc": 0.9982359409332275, "length": 3.998682975769043, "mode": "train", "epoch": 59}
{"loss": 0.06964768469333649, "acc": 0.9762152433395386, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.01522744819521904, "acc": 0.9969037175178528, "length": 3.998525619506836, "mode": "train", "epoch": 60}
{"loss": 0.08948887139558792, "acc": 0.9736111760139465, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8072413206100464
