# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.701974093914032, "acc": 0.5106601715087891, "length": 3.3071303367614746, "mode": "train", "epoch": 1}
{"loss": 0.7035551071166992, "acc": 0.47437724471092224, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6886394023895264, "acc": 0.5431853532791138, "length": 2.172499418258667, "mode": "train", "epoch": 2}
{"loss": 0.7007757425308228, "acc": 0.4777580201625824, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6487686038017273, "acc": 0.6598097085952759, "length": 2.307016372680664, "mode": "train", "epoch": 3}
{"loss": 0.608837902545929, "acc": 0.6858857274055481, "length": 2.72953724861145, "mode": "test", "epoch": 3}
{"loss": 0.5668768286705017, "acc": 0.7312694787979126, "length": 2.72491192817688, "mode": "train", "epoch": 4}
{"loss": 0.53728187084198, "acc": 0.720503568649292, "length": 2.900355815887451, "mode": "test", "epoch": 4}
{"loss": 0.4973788857460022, "acc": 0.7646065950393677, "length": 2.870276927947998, "mode": "train", "epoch": 5}
{"loss": 0.49921417236328125, "acc": 0.7933245897293091, "length": 2.765124559402466, "mode": "test", "epoch": 5}
{"loss": 0.466242253780365, "acc": 0.7986641526222229, "length": 2.763793706893921, "mode": "train", "epoch": 6}
{"loss": 0.479856014251709, "acc": 0.7962332367897034, "length": 2.8007116317749023, "mode": "test", "epoch": 6}
{"loss": 0.45612072944641113, "acc": 0.8106305599212646, "length": 2.7616186141967773, "mode": "train", "epoch": 7}
{"loss": 0.477607786655426, "acc": 0.7814897298812866, "length": 2.90747332572937, "mode": "test", "epoch": 7}
{"loss": 0.4459365904331207, "acc": 0.8006394505500793, "length": 2.731522798538208, "mode": "train", "epoch": 8}
{"loss": 0.47605735063552856, "acc": 0.8025017380714417, "length": 2.736654758453369, "mode": "test", "epoch": 8}
{"loss": 0.4319348633289337, "acc": 0.814763605594635, "length": 2.738999366760254, "mode": "train", "epoch": 9}
{"loss": 0.4669879376888275, "acc": 0.8042032122612, "length": 2.7259786128997803, "mode": "test", "epoch": 9}
{"loss": 0.4311663508415222, "acc": 0.817650318145752, "length": 2.738187789916992, "mode": "train", "epoch": 10}
{"loss": 0.4607684314250946, "acc": 0.7945749759674072, "length": 2.928825616836548, "mode": "test", "epoch": 10}
{"loss": 0.39593541622161865, "acc": 0.8213929533958435, "length": 2.8713366985321045, "mode": "train", "epoch": 11}
{"loss": 0.4393859803676605, "acc": 0.8165473341941833, "length": 2.8754448890686035, "mode": "test", "epoch": 11}
{"loss": 0.3740949034690857, "acc": 0.8423938155174255, "length": 3.0407447814941406, "mode": "train", "epoch": 12}
{"loss": 0.4059467017650604, "acc": 0.8235580325126648, "length": 3.4555160999298096, "mode": "test", "epoch": 12}
{"loss": 0.3438092768192291, "acc": 0.8571250438690186, "length": 3.2565362453460693, "mode": "train", "epoch": 13}
{"loss": 0.37048694491386414, "acc": 0.8473923802375793, "length": 3.5338077545166016, "mode": "test", "epoch": 13}
{"loss": 0.2987617552280426, "acc": 0.871120035648346, "length": 3.508310079574585, "mode": "train", "epoch": 14}
{"loss": 0.37076058983802795, "acc": 0.8506039381027222, "length": 3.6085410118103027, "mode": "test", "epoch": 14}
{"loss": 0.2743888199329376, "acc": 0.8976384997367859, "length": 3.4537570476531982, "mode": "train", "epoch": 15}
{"loss": 0.33473262190818787, "acc": 0.871061384677887, "length": 3.81850528717041, "mode": "test", "epoch": 15}
{"loss": 0.240775465965271, "acc": 0.9010310769081116, "length": 3.6779839992523193, "mode": "train", "epoch": 16}
{"loss": 0.30958014726638794, "acc": 0.8822146654129028, "length": 3.9679715633392334, "mode": "test", "epoch": 16}
{"loss": 0.22092463076114655, "acc": 0.9135692715644836, "length": 3.69795298576355, "mode": "train", "epoch": 17}
{"loss": 0.2915979325771332, "acc": 0.8931189179420471, "length": 3.832740306854248, "mode": "test", "epoch": 17}
{"loss": 0.21846380829811096, "acc": 0.9146170020103455, "length": 3.6600136756896973, "mode": "train", "epoch": 18}
{"loss": 0.2774132490158081, "acc": 0.8930709958076477, "length": 3.750889778137207, "mode": "test", "epoch": 18}
{"loss": 0.19859369099140167, "acc": 0.9190369844436646, "length": 3.6281399726867676, "mode": "train", "epoch": 19}
{"loss": 0.25252947211265564, "acc": 0.9068588018417358, "length": 3.914590835571289, "mode": "test", "epoch": 19}
{"loss": 0.18959049880504608, "acc": 0.921560525894165, "length": 3.6452505588531494, "mode": "train", "epoch": 20}
{"loss": 0.2540838420391083, "acc": 0.9121155738830566, "length": 3.7935943603515625, "mode": "test", "epoch": 20}
{"loss": 0.18033675849437714, "acc": 0.9301999807357788, "length": 3.683887004852295, "mode": "train", "epoch": 21}
{"loss": 0.20349013805389404, "acc": 0.9242730736732483, "length": 3.7935943603515625, "mode": "test", "epoch": 21}
{"loss": 0.167009636759758, "acc": 0.9321596622467041, "length": 3.697127103805542, "mode": "train", "epoch": 22}
{"loss": 0.22134916484355927, "acc": 0.9140471816062927, "length": 3.8647687435150146, "mode": "test", "epoch": 22}
{"loss": 0.15557844936847687, "acc": 0.9428853392601013, "length": 3.755401372909546, "mode": "train", "epoch": 23}
{"loss": 0.1678297072649002, "acc": 0.9391970634460449, "length": 3.846975088119507, "mode": "test", "epoch": 23}
{"loss": 0.1461944431066513, "acc": 0.9397903680801392, "length": 3.7751922607421875, "mode": "train", "epoch": 24}
{"loss": 0.17058037221431732, "acc": 0.9408973455429077, "length": 3.8754448890686035, "mode": "test", "epoch": 24}
{"loss": 0.1361803114414215, "acc": 0.9434897303581238, "length": 3.776876926422119, "mode": "train", "epoch": 25}
{"loss": 0.15821024775505066, "acc": 0.9406147599220276, "length": 3.829181432723999, "mode": "test", "epoch": 25}
{"loss": 0.12209314107894897, "acc": 0.9493924975395203, "length": 3.8221027851104736, "mode": "train", "epoch": 26}
{"loss": 0.16104942560195923, "acc": 0.9421192407608032, "length": 3.928825616836548, "mode": "test", "epoch": 26}
{"loss": 0.10823006927967072, "acc": 0.9553467631340027, "length": 3.853118896484375, "mode": "train", "epoch": 27}
{"loss": 0.14476613700389862, "acc": 0.9451584815979004, "length": 3.921708106994629, "mode": "test", "epoch": 27}
{"loss": 0.10992154479026794, "acc": 0.9586138129234314, "length": 3.8509433269500732, "mode": "train", "epoch": 28}
{"loss": 0.13024964928627014, "acc": 0.9537810683250427, "length": 3.9323842525482178, "mode": "test", "epoch": 28}
{"loss": 0.10534299165010452, "acc": 0.9590490460395813, "length": 3.873819351196289, "mode": "train", "epoch": 29}
{"loss": 0.12637697160243988, "acc": 0.9529908895492554, "length": 3.9323842525482178, "mode": "test", "epoch": 29}
{"loss": 0.10228876024484634, "acc": 0.9564208388328552, "length": 3.864074230194092, "mode": "train", "epoch": 30}
{"loss": 0.1133633479475975, "acc": 0.9573997259140015, "length": 3.935943126678467, "mode": "test", "epoch": 30}
{"loss": 0.0943080335855484, "acc": 0.9616553783416748, "length": 3.8863890171051025, "mode": "train", "epoch": 31}
{"loss": 0.13576073944568634, "acc": 0.9519250392913818, "length": 3.928825616836548, "mode": "test", "epoch": 31}
{"loss": 0.0998762771487236, "acc": 0.9642481207847595, "length": 3.8972527980804443, "mode": "train", "epoch": 32}
{"loss": 0.10278232395648956, "acc": 0.9579890370368958, "length": 3.928825616836548, "mode": "test", "epoch": 32}
{"loss": 0.09478025138378143, "acc": 0.9573321342468262, "length": 3.9027836322784424, "mode": "train", "epoch": 33}
{"loss": 0.1218448206782341, "acc": 0.9461082220077515, "length": 3.935943126678467, "mode": "test", "epoch": 33}
{"loss": 0.11452850699424744, "acc": 0.9605144262313843, "length": 3.896209716796875, "mode": "train", "epoch": 34}
{"loss": 0.11143447458744049, "acc": 0.9573788046836853, "length": 3.9750890731811523, "mode": "test", "epoch": 34}
{"loss": 0.10914479196071625, "acc": 0.9581411480903625, "length": 3.9695355892181396, "mode": "train", "epoch": 35}
{"loss": 0.13221068680286407, "acc": 0.956939697265625, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.08216273039579391, "acc": 0.9656366109848022, "length": 3.9569649696350098, "mode": "train", "epoch": 36}
{"loss": 0.10632625967264175, "acc": 0.9582405686378479, "length": 3.9786477088928223, "mode": "test", "epoch": 36}
{"loss": 0.08160784840583801, "acc": 0.967096745967865, "length": 3.9439146518707275, "mode": "train", "epoch": 37}
{"loss": 0.13087494671344757, "acc": 0.9537867307662964, "length": 3.992882490158081, "mode": "test", "epoch": 37}
{"loss": 0.08456329256296158, "acc": 0.9680142402648926, "length": 3.943467378616333, "mode": "train", "epoch": 38}
{"loss": 0.09934854507446289, "acc": 0.9687973260879517, "length": 3.99644136428833, "mode": "test", "epoch": 38}
{"loss": 0.08621013909578323, "acc": 0.970413863658905, "length": 3.953958034515381, "mode": "train", "epoch": 39}
{"loss": 0.09106665104627609, "acc": 0.9679716229438782, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.08917608857154846, "acc": 0.9710255861282349, "length": 3.9704811573028564, "mode": "train", "epoch": 40}
{"loss": 0.10152523964643478, "acc": 0.9683274030685425, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.07716523110866547, "acc": 0.973167896270752, "length": 3.967869758605957, "mode": "train", "epoch": 41}
{"loss": 0.0743742287158966, "acc": 0.9754449725151062, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.09282246232032776, "acc": 0.96916663646698, "length": 3.961115598678589, "mode": "train", "epoch": 42}
{"loss": 0.09502723067998886, "acc": 0.9661921858787537, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.08098314702510834, "acc": 0.970281183719635, "length": 3.978025197982788, "mode": "train", "epoch": 43}
{"loss": 0.07992970198392868, "acc": 0.9733095169067383, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.06187114864587784, "acc": 0.9757075905799866, "length": 3.9770796298980713, "mode": "train", "epoch": 44}
{"loss": 0.08358383923768997, "acc": 0.9724199175834656, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.04879152029752731, "acc": 0.9804549217224121, "length": 3.9759318828582764, "mode": "train", "epoch": 45}
{"loss": 0.09109977632761002, "acc": 0.9704625606536865, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.057840745896101, "acc": 0.9813780784606934, "length": 3.9733569622039795, "mode": "train", "epoch": 46}
{"loss": 0.05532906576991081, "acc": 0.9832741022109985, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.05509016662836075, "acc": 0.9829270243644714, "length": 3.9868268966674805, "mode": "train", "epoch": 47}
{"loss": 0.05929342657327652, "acc": 0.9779359102249146, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.051962994039058685, "acc": 0.9810006022453308, "length": 3.9829163551330566, "mode": "train", "epoch": 48}
{"loss": 0.06240464001893997, "acc": 0.9788256883621216, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.043104417622089386, "acc": 0.9845425486564636, "length": 3.99002742767334, "mode": "train", "epoch": 49}
{"loss": 0.06980997323989868, "acc": 0.9754447340965271, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.03604109585285187, "acc": 0.9862838983535767, "length": 3.9918971061706543, "mode": "train", "epoch": 50}
{"loss": 0.054933685809373856, "acc": 0.9829183220863342, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.03659135103225708, "acc": 0.986821711063385, "length": 3.9911155700683594, "mode": "train", "epoch": 51}
{"loss": 0.05534350499510765, "acc": 0.9836298823356628, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.03831467777490616, "acc": 0.9886987209320068, "length": 3.9933042526245117, "mode": "train", "epoch": 52}
{"loss": 0.03444578871130943, "acc": 0.9857649207115173, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.02808223105967045, "acc": 0.9909693598747253, "length": 3.9920926094055176, "mode": "train", "epoch": 53}
{"loss": 0.028390413150191307, "acc": 0.9895018339157104, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.026087751612067223, "acc": 0.9906291961669922, "length": 3.992678165435791, "mode": "train", "epoch": 54}
{"loss": 0.04312507435679436, "acc": 0.9864767789840698, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.024135028943419456, "acc": 0.9918239116668701, "length": 3.9942562580108643, "mode": "train", "epoch": 55}
{"loss": 0.022781504318118095, "acc": 0.9934162497520447, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.02190922386944294, "acc": 0.993536651134491, "length": 3.9951531887054443, "mode": "train", "epoch": 56}
{"loss": 0.039968833327293396, "acc": 0.987366795539856, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.02805093117058277, "acc": 0.9918183088302612, "length": 3.9955320358276367, "mode": "train", "epoch": 57}
{"loss": 0.029766350984573364, "acc": 0.9900356531143188, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.029410915449261665, "acc": 0.9891478419303894, "length": 3.9968960285186768, "mode": "train", "epoch": 58}
{"loss": 0.04807714745402336, "acc": 0.9879002571105957, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.03326987847685814, "acc": 0.9910321235656738, "length": 3.998412609100342, "mode": "train", "epoch": 59}
{"loss": 0.029081925749778748, "acc": 0.9862989187240601, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.02401307411491871, "acc": 0.9916777014732361, "length": 3.9962077140808105, "mode": "train", "epoch": 60}
{"loss": 0.023752547800540924, "acc": 0.9948399066925049, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9273437261581421
