# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6983705759048462, "acc": 0.5069599747657776, "length": 3.545682430267334, "mode": "train", "epoch": 1}
{"loss": 0.6882237195968628, "acc": 0.5298560857772827, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6901066899299622, "acc": 0.545962393283844, "length": 3.3384029865264893, "mode": "train", "epoch": 2}
{"loss": 0.6885616183280945, "acc": 0.5442447066307068, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6880425214767456, "acc": 0.5421128869056702, "length": 3.1333096027374268, "mode": "train", "epoch": 3}
{"loss": 0.6742649078369141, "acc": 0.5883227586746216, "length": 1.7553956508636475, "mode": "test", "epoch": 3}
{"loss": 0.6741687655448914, "acc": 0.5876365900039673, "length": 3.0700747966766357, "mode": "train", "epoch": 4}
{"loss": 0.6388088464736938, "acc": 0.680268406867981, "length": 3.7194244861602783, "mode": "test", "epoch": 4}
{"loss": 0.6418068408966064, "acc": 0.6665464043617249, "length": 3.477463722229004, "mode": "train", "epoch": 5}
{"loss": 0.5930006504058838, "acc": 0.7143884897232056, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.588342547416687, "acc": 0.7217463850975037, "length": 3.8381094932556152, "mode": "train", "epoch": 6}
{"loss": 0.5615835189819336, "acc": 0.7228416800498962, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.5622523427009583, "acc": 0.7299323678016663, "length": 3.9444899559020996, "mode": "train", "epoch": 7}
{"loss": 0.520117998123169, "acc": 0.7649281620979309, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.5351569056510925, "acc": 0.7413399815559387, "length": 3.9537453651428223, "mode": "train", "epoch": 8}
{"loss": 0.49766093492507935, "acc": 0.7636690735816956, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.5092839002609253, "acc": 0.7589765191078186, "length": 3.9660565853118896, "mode": "train", "epoch": 9}
{"loss": 0.49907541275024414, "acc": 0.7678057551383972, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.4800081253051758, "acc": 0.7801113724708557, "length": 3.980323553085327, "mode": "train", "epoch": 10}
{"loss": 0.47069251537323, "acc": 0.7778777480125427, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4590063989162445, "acc": 0.8001322150230408, "length": 3.9844093322753906, "mode": "train", "epoch": 11}
{"loss": 0.45854243636131287, "acc": 0.7953237891197205, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.4333065450191498, "acc": 0.8084010481834412, "length": 3.9872055053710938, "mode": "train", "epoch": 12}
{"loss": 0.4259912371635437, "acc": 0.8188848495483398, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.4133569896221161, "acc": 0.8187276124954224, "length": 3.9882943630218506, "mode": "train", "epoch": 13}
{"loss": 0.3980392813682556, "acc": 0.8239208459854126, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3858139216899872, "acc": 0.8312101364135742, "length": 3.9898622035980225, "mode": "train", "epoch": 14}
{"loss": 0.3920345902442932, "acc": 0.8289569020271301, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3613838851451874, "acc": 0.8467420339584351, "length": 3.990168571472168, "mode": "train", "epoch": 15}
{"loss": 0.3687474727630615, "acc": 0.8485611081123352, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.33074504137039185, "acc": 0.8598535060882568, "length": 3.989915609359741, "mode": "train", "epoch": 16}
{"loss": 0.3486526906490326, "acc": 0.8553957343101501, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.3107391893863678, "acc": 0.8723244071006775, "length": 3.9942572116851807, "mode": "train", "epoch": 17}
{"loss": 0.3511083126068115, "acc": 0.8532374501228333, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.30415189266204834, "acc": 0.8710846304893494, "length": 3.992387533187866, "mode": "train", "epoch": 18}
{"loss": 0.3172416090965271, "acc": 0.8690648078918457, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.2855530381202698, "acc": 0.8774626851081848, "length": 3.996356964111328, "mode": "train", "epoch": 19}
{"loss": 0.3233433961868286, "acc": 0.8616908192634583, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.27935612201690674, "acc": 0.8849951028823853, "length": 3.9930262565612793, "mode": "train", "epoch": 20}
{"loss": 0.3253486156463623, "acc": 0.8562950491905212, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.26979875564575195, "acc": 0.886428713798523, "length": 3.997112274169922, "mode": "train", "epoch": 21}
{"loss": 0.3096942901611328, "acc": 0.8697841763496399, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.25818970799446106, "acc": 0.8925740122795105, "length": 3.9956510066986084, "mode": "train", "epoch": 22}
{"loss": 0.28908228874206543, "acc": 0.8708633780479431, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2580208480358124, "acc": 0.8917950391769409, "length": 3.997945547103882, "mode": "train", "epoch": 23}
{"loss": 0.30924054980278015, "acc": 0.8624099493026733, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.25324568152427673, "acc": 0.8966788053512573, "length": 3.9992547035217285, "mode": "train", "epoch": 24}
{"loss": 0.2862849235534668, "acc": 0.8784171342849731, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2503070831298828, "acc": 0.8968144655227661, "length": 3.9964711666107178, "mode": "train", "epoch": 25}
{"loss": 0.29221412539482117, "acc": 0.8670863509178162, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.24080348014831543, "acc": 0.8971580862998962, "length": 3.999263286590576, "mode": "train", "epoch": 26}
{"loss": 0.27724385261535645, "acc": 0.8884891271591187, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.23910799622535706, "acc": 0.9002211093902588, "length": 3.998962879180908, "mode": "train", "epoch": 27}
{"loss": 0.28584083914756775, "acc": 0.8769784569740295, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.23515242338180542, "acc": 0.9017326831817627, "length": 3.9995689392089844, "mode": "train", "epoch": 28}
{"loss": 0.27840226888656616, "acc": 0.8931654095649719, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.22397185862064362, "acc": 0.9050803780555725, "length": 3.9990792274475098, "mode": "train", "epoch": 29}
{"loss": 0.25949785113334656, "acc": 0.8969424962997437, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.2240082025527954, "acc": 0.9141539335250854, "length": 3.9987661838531494, "mode": "train", "epoch": 30}
{"loss": 0.24154067039489746, "acc": 0.904136598110199, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.2071002572774887, "acc": 0.9136945009231567, "length": 3.999659538269043, "mode": "train", "epoch": 31}
{"loss": 0.23587828874588013, "acc": 0.9104316234588623, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.1989099383354187, "acc": 0.9212646484375, "length": 3.9997804164886475, "mode": "train", "epoch": 32}
{"loss": 0.23288285732269287, "acc": 0.8960431814193726, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.1907401978969574, "acc": 0.9232386946678162, "length": 3.999464273452759, "mode": "train", "epoch": 33}
{"loss": 0.21200285851955414, "acc": 0.9145683646202087, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1813543736934662, "acc": 0.9266359806060791, "length": 3.99891996383667, "mode": "train", "epoch": 34}
{"loss": 0.20828507840633392, "acc": 0.9156475067138672, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.18469001352787018, "acc": 0.9284541010856628, "length": 3.9990999698638916, "mode": "train", "epoch": 35}
{"loss": 0.19871917366981506, "acc": 0.9217624664306641, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.17802296578884125, "acc": 0.9297440052032471, "length": 3.998020648956299, "mode": "train", "epoch": 36}
{"loss": 0.18062232434749603, "acc": 0.923561155796051, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.17654472589492798, "acc": 0.9301074147224426, "length": 3.9999747276306152, "mode": "train", "epoch": 37}
{"loss": 0.1699800193309784, "acc": 0.9287770390510559, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.16374723613262177, "acc": 0.9350884556770325, "length": 3.9997739791870117, "mode": "train", "epoch": 38}
{"loss": 0.18817004561424255, "acc": 0.9318344593048096, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.1570713073015213, "acc": 0.9383313059806824, "length": 3.9987943172454834, "mode": "train", "epoch": 39}
{"loss": 0.15564998984336853, "acc": 0.9343525171279907, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.1513597071170807, "acc": 0.9421858191490173, "length": 3.9999430179595947, "mode": "train", "epoch": 40}
{"loss": 0.15202376246452332, "acc": 0.9390288591384888, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1472460925579071, "acc": 0.9429490566253662, "length": 3.9995222091674805, "mode": "train", "epoch": 41}
{"loss": 0.17048536241054535, "acc": 0.9384891986846924, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1494518369436264, "acc": 0.94451904296875, "length": 3.9993162155151367, "mode": "train", "epoch": 42}
{"loss": 0.15785889327526093, "acc": 0.9451437592506409, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.15147118270397186, "acc": 0.9438692331314087, "length": 3.999985694885254, "mode": "train", "epoch": 43}
{"loss": 0.16578277945518494, "acc": 0.9415467381477356, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.14638172090053558, "acc": 0.9436289072036743, "length": 3.99996280670166, "mode": "train", "epoch": 44}
{"loss": 0.15307852625846863, "acc": 0.9469424486160278, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.13998903334140778, "acc": 0.9457827210426331, "length": 3.999735116958618, "mode": "train", "epoch": 45}
{"loss": 0.15101751685142517, "acc": 0.9465826153755188, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.14052611589431763, "acc": 0.9471148252487183, "length": 3.9999754428863525, "mode": "train", "epoch": 46}
{"loss": 0.1441437005996704, "acc": 0.9510791301727295, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.13450682163238525, "acc": 0.9466301798820496, "length": 3.999882221221924, "mode": "train", "epoch": 47}
{"loss": 0.1457180678844452, "acc": 0.9523381590843201, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.13197217881679535, "acc": 0.9512644410133362, "length": 3.998936653137207, "mode": "train", "epoch": 48}
{"loss": 0.1509595364332199, "acc": 0.9473021626472473, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.13466958701610565, "acc": 0.9517125487327576, "length": 3.9996213912963867, "mode": "train", "epoch": 49}
{"loss": 0.1445397436618805, "acc": 0.948381245136261, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.1296272724866867, "acc": 0.9506606459617615, "length": 3.999983072280884, "mode": "train", "epoch": 50}
{"loss": 0.14265133440494537, "acc": 0.9532372951507568, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12311655282974243, "acc": 0.9534711837768555, "length": 3.9996984004974365, "mode": "train", "epoch": 51}
{"loss": 0.1594741940498352, "acc": 0.9469424486160278, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.12609417736530304, "acc": 0.950239896774292, "length": 3.9999876022338867, "mode": "train", "epoch": 52}
{"loss": 0.13335777819156647, "acc": 0.9474821090698242, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.12424858659505844, "acc": 0.9531848430633545, "length": 3.9999947547912598, "mode": "train", "epoch": 53}
{"loss": 0.12869030237197876, "acc": 0.9516186714172363, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.12557515501976013, "acc": 0.9512612819671631, "length": 3.999976873397827, "mode": "train", "epoch": 54}
{"loss": 0.12764915823936462, "acc": 0.9523382186889648, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.11211463809013367, "acc": 0.9589539766311646, "length": 3.999993324279785, "mode": "train", "epoch": 55}
{"loss": 0.16946880519390106, "acc": 0.9521580934524536, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.11610646545886993, "acc": 0.9587008953094482, "length": 3.9994418621063232, "mode": "train", "epoch": 56}
{"loss": 0.12064596265554428, "acc": 0.9595322608947754, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.10394500195980072, "acc": 0.9629783630371094, "length": 3.9999704360961914, "mode": "train", "epoch": 57}
{"loss": 0.11729277670383453, "acc": 0.9589929580688477, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.10665888339281082, "acc": 0.960438072681427, "length": 3.9996495246887207, "mode": "train", "epoch": 58}
{"loss": 0.11709517240524292, "acc": 0.9543164968490601, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.10132434219121933, "acc": 0.9599157571792603, "length": 3.999997854232788, "mode": "train", "epoch": 59}
{"loss": 0.1100640743970871, "acc": 0.9652876853942871, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.09781672805547714, "acc": 0.9653843641281128, "length": 3.999990224838257, "mode": "train", "epoch": 60}
{"loss": 0.10904794931411743, "acc": 0.9582732319831848, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8650002479553223
