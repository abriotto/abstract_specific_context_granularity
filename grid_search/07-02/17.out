# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7005593776702881, "acc": 0.4940605163574219, "length": 3.4969823360443115, "mode": "train", "epoch": 1}
{"loss": 0.694237470626831, "acc": 0.5052083730697632, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6920900940895081, "acc": 0.5170454382896423, "length": 3.4388928413391113, "mode": "train", "epoch": 2}
{"loss": 0.6955110430717468, "acc": 0.5065972805023193, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.691284716129303, "acc": 0.5096590518951416, "length": 3.3823633193969727, "mode": "train", "epoch": 3}
{"loss": 0.6947120428085327, "acc": 0.5177083015441895, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6897333860397339, "acc": 0.5316765904426575, "length": 3.276423454284668, "mode": "train", "epoch": 4}
{"loss": 0.693877637386322, "acc": 0.5057291984558105, "length": 1.0, "mode": "test", "epoch": 4}
{"loss": 0.6874315738677979, "acc": 0.5335551500320435, "length": 3.0782530307769775, "mode": "train", "epoch": 5}
{"loss": 0.6931567192077637, "acc": 0.5109497308731079, "length": 1.0173611640930176, "mode": "test", "epoch": 5}
{"loss": 0.6810816526412964, "acc": 0.5770618319511414, "length": 2.8205058574676514, "mode": "train", "epoch": 6}
{"loss": 0.6701270937919617, "acc": 0.6417493224143982, "length": 1.8402777910232544, "mode": "test", "epoch": 6}
{"loss": 0.6667159199714661, "acc": 0.6457947492599487, "length": 2.858654499053955, "mode": "train", "epoch": 7}
{"loss": 0.6465035676956177, "acc": 0.6994642615318298, "length": 2.4791667461395264, "mode": "test", "epoch": 7}
{"loss": 0.6435335874557495, "acc": 0.6865602731704712, "length": 2.8754637241363525, "mode": "train", "epoch": 8}
{"loss": 0.62098228931427, "acc": 0.7112318873405457, "length": 2.7291667461395264, "mode": "test", "epoch": 8}
{"loss": 0.610935628414154, "acc": 0.7214751839637756, "length": 2.9051074981689453, "mode": "train", "epoch": 9}
{"loss": 0.5939620733261108, "acc": 0.7221070528030396, "length": 2.8576388359069824, "mode": "test", "epoch": 9}
{"loss": 0.5743914842605591, "acc": 0.7342119812965393, "length": 2.9254167079925537, "mode": "train", "epoch": 10}
{"loss": 0.5677189230918884, "acc": 0.746569812297821, "length": 2.9270832538604736, "mode": "test", "epoch": 10}
{"loss": 0.5425381660461426, "acc": 0.7473899126052856, "length": 2.9887876510620117, "mode": "train", "epoch": 11}
{"loss": 0.5486211180686951, "acc": 0.7653795480728149, "length": 2.965277671813965, "mode": "test", "epoch": 11}
{"loss": 0.513812780380249, "acc": 0.7678638100624084, "length": 3.077956199645996, "mode": "train", "epoch": 12}
{"loss": 0.5375164747238159, "acc": 0.7774007320404053, "length": 3.0451388359069824, "mode": "test", "epoch": 12}
{"loss": 0.4862266778945923, "acc": 0.7944630980491638, "length": 3.1471619606018066, "mode": "train", "epoch": 13}
{"loss": 0.5263111591339111, "acc": 0.7816311120986938, "length": 3.090277671813965, "mode": "test", "epoch": 13}
{"loss": 0.46443143486976624, "acc": 0.8077762722969055, "length": 3.166233777999878, "mode": "train", "epoch": 14}
{"loss": 0.5238734483718872, "acc": 0.7812675833702087, "length": 3.305555582046509, "mode": "test", "epoch": 14}
{"loss": 0.44010376930236816, "acc": 0.8149436116218567, "length": 3.301382064819336, "mode": "train", "epoch": 15}
{"loss": 0.4999180734157562, "acc": 0.7921739816665649, "length": 3.3645832538604736, "mode": "test", "epoch": 15}
{"loss": 0.4143802523612976, "acc": 0.8220512270927429, "length": 3.3935048580169678, "mode": "train", "epoch": 16}
{"loss": 0.4483978748321533, "acc": 0.8080471158027649, "length": 3.6666667461395264, "mode": "test", "epoch": 16}
{"loss": 0.3836230933666229, "acc": 0.8391057848930359, "length": 3.559032678604126, "mode": "train", "epoch": 17}
{"loss": 0.4306321144104004, "acc": 0.8210015296936035, "length": 3.840277671813965, "mode": "test", "epoch": 17}
{"loss": 0.35434263944625854, "acc": 0.8485276699066162, "length": 3.72518253326416, "mode": "train", "epoch": 18}
{"loss": 0.43205973505973816, "acc": 0.8261041045188904, "length": 3.965277671813965, "mode": "test", "epoch": 18}
{"loss": 0.3362944722175598, "acc": 0.8581753373146057, "length": 3.817379951477051, "mode": "train", "epoch": 19}
{"loss": 0.4344639480113983, "acc": 0.8236055374145508, "length": 3.96875, "mode": "test", "epoch": 19}
{"loss": 0.32696616649627686, "acc": 0.8610917925834656, "length": 3.849134683609009, "mode": "train", "epoch": 20}
{"loss": 0.4212450683116913, "acc": 0.8320691585540771, "length": 3.972222328186035, "mode": "test", "epoch": 20}
{"loss": 0.31708741188049316, "acc": 0.8672693967819214, "length": 3.880784273147583, "mode": "train", "epoch": 21}
{"loss": 0.43888673186302185, "acc": 0.83123379945755, "length": 3.9791667461395264, "mode": "test", "epoch": 21}
{"loss": 0.31100577116012573, "acc": 0.8692011833190918, "length": 3.8949263095855713, "mode": "train", "epoch": 22}
{"loss": 0.42538484930992126, "acc": 0.8348037004470825, "length": 3.9861111640930176, "mode": "test", "epoch": 22}
{"loss": 0.3073100745677948, "acc": 0.8701443076133728, "length": 3.9002394676208496, "mode": "train", "epoch": 23}
{"loss": 0.41745221614837646, "acc": 0.8373711109161377, "length": 3.9895832538604736, "mode": "test", "epoch": 23}
{"loss": 0.3016219139099121, "acc": 0.8709909915924072, "length": 3.891350507736206, "mode": "train", "epoch": 24}
{"loss": 0.41083940863609314, "acc": 0.8442315459251404, "length": 3.975694417953491, "mode": "test", "epoch": 24}
{"loss": 0.2996363043785095, "acc": 0.8782820701599121, "length": 3.8848581314086914, "mode": "train", "epoch": 25}
{"loss": 0.3917688727378845, "acc": 0.8418211936950684, "length": 3.9548611640930176, "mode": "test", "epoch": 25}
{"loss": 0.29695653915405273, "acc": 0.8789818286895752, "length": 3.8513498306274414, "mode": "train", "epoch": 26}
{"loss": 0.37982177734375, "acc": 0.8484673500061035, "length": 3.8958332538604736, "mode": "test", "epoch": 26}
{"loss": 0.29148751497268677, "acc": 0.8802970051765442, "length": 3.8159191608428955, "mode": "train", "epoch": 27}
{"loss": 0.390613317489624, "acc": 0.8488063812255859, "length": 3.8854167461395264, "mode": "test", "epoch": 27}
{"loss": 0.28869494795799255, "acc": 0.8840711116790771, "length": 3.8029797077178955, "mode": "train", "epoch": 28}
{"loss": 0.37966594099998474, "acc": 0.8514891862869263, "length": 3.909722328186035, "mode": "test", "epoch": 28}
{"loss": 0.2810959219932556, "acc": 0.8872775435447693, "length": 3.8500373363494873, "mode": "train", "epoch": 29}
{"loss": 0.3848455846309662, "acc": 0.8572672009468079, "length": 3.913194417953491, "mode": "test", "epoch": 29}
{"loss": 0.28437337279319763, "acc": 0.8858394026756287, "length": 3.824249029159546, "mode": "train", "epoch": 30}
{"loss": 0.37394964694976807, "acc": 0.8495957851409912, "length": 3.881944417953491, "mode": "test", "epoch": 30}
{"loss": 0.2765195071697235, "acc": 0.8899746537208557, "length": 3.8301191329956055, "mode": "train", "epoch": 31}
{"loss": 0.36971014738082886, "acc": 0.8617715835571289, "length": 3.8888888359069824, "mode": "test", "epoch": 31}
{"loss": 0.27729955315589905, "acc": 0.8921021223068237, "length": 3.8402082920074463, "mode": "train", "epoch": 32}
{"loss": 0.37038204073905945, "acc": 0.8613850474357605, "length": 3.8576388359069824, "mode": "test", "epoch": 32}
{"loss": 0.27464982867240906, "acc": 0.8924524188041687, "length": 3.813209295272827, "mode": "train", "epoch": 33}
{"loss": 0.3722466826438904, "acc": 0.8633191585540771, "length": 3.871527671813965, "mode": "test", "epoch": 33}
{"loss": 0.27129602432250977, "acc": 0.8931023478507996, "length": 3.836411714553833, "mode": "train", "epoch": 34}
{"loss": 0.36423707008361816, "acc": 0.8665459156036377, "length": 3.8888888359069824, "mode": "test", "epoch": 34}
{"loss": 0.26834267377853394, "acc": 0.8991007208824158, "length": 3.880998134613037, "mode": "train", "epoch": 35}
{"loss": 0.36501869559288025, "acc": 0.8660739064216614, "length": 3.913194417953491, "mode": "test", "epoch": 35}
{"loss": 0.2645418345928192, "acc": 0.8993751406669617, "length": 3.8546535968780518, "mode": "train", "epoch": 36}
{"loss": 0.34679579734802246, "acc": 0.870583713054657, "length": 3.840277671813965, "mode": "test", "epoch": 36}
{"loss": 0.26228421926498413, "acc": 0.8985214233398438, "length": 3.8511664867401123, "mode": "train", "epoch": 37}
{"loss": 0.3663119673728943, "acc": 0.8665242791175842, "length": 3.8923611640930176, "mode": "test", "epoch": 37}
{"loss": 0.26093000173568726, "acc": 0.8980068564414978, "length": 3.8587255477905273, "mode": "train", "epoch": 38}
{"loss": 0.34361737966537476, "acc": 0.8699163794517517, "length": 3.8854167461395264, "mode": "test", "epoch": 38}
{"loss": 0.2583191394805908, "acc": 0.9032687544822693, "length": 3.8575284481048584, "mode": "train", "epoch": 39}
{"loss": 0.34700441360473633, "acc": 0.8766547441482544, "length": 3.902777671813965, "mode": "test", "epoch": 39}
{"loss": 0.2546778619289398, "acc": 0.9023435115814209, "length": 3.8733086585998535, "mode": "train", "epoch": 40}
{"loss": 0.3392539918422699, "acc": 0.8749130964279175, "length": 3.875, "mode": "test", "epoch": 40}
{"loss": 0.2506178617477417, "acc": 0.9053277373313904, "length": 3.8510758876800537, "mode": "train", "epoch": 41}
{"loss": 0.32817912101745605, "acc": 0.8851401209831238, "length": 3.875, "mode": "test", "epoch": 41}
{"loss": 0.2500566244125366, "acc": 0.9073275923728943, "length": 3.853590726852417, "mode": "train", "epoch": 42}
{"loss": 0.32567650079727173, "acc": 0.8883165121078491, "length": 3.909722328186035, "mode": "test", "epoch": 42}
{"loss": 0.2483406662940979, "acc": 0.9035040736198425, "length": 3.8711676597595215, "mode": "train", "epoch": 43}
{"loss": 0.321075975894928, "acc": 0.8857870101928711, "length": 3.8854167461395264, "mode": "test", "epoch": 43}
{"loss": 0.24214403331279755, "acc": 0.9086107015609741, "length": 3.859990119934082, "mode": "train", "epoch": 44}
{"loss": 0.31352370977401733, "acc": 0.8928046822547913, "length": 3.871527671813965, "mode": "test", "epoch": 44}
{"loss": 0.23702308535575867, "acc": 0.9102050065994263, "length": 3.851041078567505, "mode": "train", "epoch": 45}
{"loss": 0.3137798607349396, "acc": 0.891864538192749, "length": 3.881944417953491, "mode": "test", "epoch": 45}
{"loss": 0.2399073839187622, "acc": 0.9095744490623474, "length": 3.870387554168701, "mode": "train", "epoch": 46}
{"loss": 0.30841487646102905, "acc": 0.8979017734527588, "length": 3.899305582046509, "mode": "test", "epoch": 46}
{"loss": 0.23732270300388336, "acc": 0.9107198119163513, "length": 3.8784961700439453, "mode": "train", "epoch": 47}
{"loss": 0.30110761523246765, "acc": 0.8964248299598694, "length": 3.8923611640930176, "mode": "test", "epoch": 47}
{"loss": 0.23018395900726318, "acc": 0.9152111411094666, "length": 3.8706493377685547, "mode": "train", "epoch": 48}
{"loss": 0.2990643382072449, "acc": 0.8993218541145325, "length": 3.8923611640930176, "mode": "test", "epoch": 48}
{"loss": 0.23277975618839264, "acc": 0.9118030667304993, "length": 3.850228786468506, "mode": "train", "epoch": 49}
{"loss": 0.31262314319610596, "acc": 0.8994765877723694, "length": 3.8958332538604736, "mode": "test", "epoch": 49}
{"loss": 0.2294692099094391, "acc": 0.913998007774353, "length": 3.8577206134796143, "mode": "train", "epoch": 50}
{"loss": 0.29923015832901, "acc": 0.8996174931526184, "length": 3.913194417953491, "mode": "test", "epoch": 50}
{"loss": 0.22800213098526, "acc": 0.9144449830055237, "length": 3.895219087600708, "mode": "train", "epoch": 51}
{"loss": 0.29689866304397583, "acc": 0.8991617560386658, "length": 3.8923611640930176, "mode": "test", "epoch": 51}
{"loss": 0.22949029505252838, "acc": 0.9117252230644226, "length": 3.873150587081909, "mode": "train", "epoch": 52}
{"loss": 0.3079335391521454, "acc": 0.8954657316207886, "length": 3.8958332538604736, "mode": "test", "epoch": 52}
{"loss": 0.2259734869003296, "acc": 0.9141967296600342, "length": 3.8585586547851562, "mode": "train", "epoch": 53}
{"loss": 0.29605746269226074, "acc": 0.9024387001991272, "length": 3.902777671813965, "mode": "test", "epoch": 53}
{"loss": 0.22748467326164246, "acc": 0.9131743311882019, "length": 3.8834550380706787, "mode": "train", "epoch": 54}
{"loss": 0.2902359664440155, "acc": 0.902195930480957, "length": 3.8958332538604736, "mode": "test", "epoch": 54}
{"loss": 0.217376708984375, "acc": 0.9159126281738281, "length": 3.8651540279388428, "mode": "train", "epoch": 55}
{"loss": 0.2768281102180481, "acc": 0.9033053517341614, "length": 3.881944417953491, "mode": "test", "epoch": 55}
{"loss": 0.21615196764469147, "acc": 0.9181220531463623, "length": 3.8785758018493652, "mode": "train", "epoch": 56}
{"loss": 0.2853034734725952, "acc": 0.9010375142097473, "length": 3.913194417953491, "mode": "test", "epoch": 56}
{"loss": 0.212154358625412, "acc": 0.9199208617210388, "length": 3.9014699459075928, "mode": "train", "epoch": 57}
{"loss": 0.2771444022655487, "acc": 0.9046264290809631, "length": 3.909722328186035, "mode": "test", "epoch": 57}
{"loss": 0.2104509025812149, "acc": 0.920840322971344, "length": 3.887307643890381, "mode": "train", "epoch": 58}
{"loss": 0.28670457005500793, "acc": 0.9024875164031982, "length": 3.9166667461395264, "mode": "test", "epoch": 58}
{"loss": 0.21062013506889343, "acc": 0.9195088148117065, "length": 3.883314371109009, "mode": "train", "epoch": 59}
{"loss": 0.28154873847961426, "acc": 0.9082410335540771, "length": 3.909722328186035, "mode": "test", "epoch": 59}
{"loss": 0.2056722790002823, "acc": 0.9233208894729614, "length": 3.881852865219116, "mode": "train", "epoch": 60}
{"loss": 0.2802719175815582, "acc": 0.9047674536705017, "length": 3.9166667461395264, "mode": "test", "epoch": 60}
test accuracy: 0.8690873384475708
