# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=64", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.6945215463638306, "acc": 0.521588921546936, "length": 3.5148258209228516, "mode": "train", "epoch": 1}
{"loss": 0.6818495988845825, "acc": 0.5702031850814819, "length": 1.3195875883102417, "mode": "test", "epoch": 1}
{"loss": 0.6819917559623718, "acc": 0.5588305592536926, "length": 3.325709819793701, "mode": "train", "epoch": 2}
{"loss": 0.6449899673461914, "acc": 0.694875955581665, "length": 3.4879724979400635, "mode": "test", "epoch": 2}
{"loss": 0.6159235835075378, "acc": 0.695521354675293, "length": 3.6639978885650635, "mode": "train", "epoch": 3}
{"loss": 0.5637679100036621, "acc": 0.7185567617416382, "length": 4.0, "mode": "test", "epoch": 3}
{"loss": 0.5406405925750732, "acc": 0.7230820655822754, "length": 3.955763339996338, "mode": "train", "epoch": 4}
{"loss": 0.5062794089317322, "acc": 0.7786941528320312, "length": 4.0, "mode": "test", "epoch": 4}
{"loss": 0.46991705894470215, "acc": 0.7918354272842407, "length": 3.975370407104492, "mode": "train", "epoch": 5}
{"loss": 0.4614602029323578, "acc": 0.807216465473175, "length": 4.0, "mode": "test", "epoch": 5}
{"loss": 0.4390108585357666, "acc": 0.8062835335731506, "length": 3.9705393314361572, "mode": "train", "epoch": 6}
{"loss": 0.4584677815437317, "acc": 0.8049828410148621, "length": 4.0, "mode": "test", "epoch": 6}
{"loss": 0.41189634799957275, "acc": 0.8177571892738342, "length": 3.9782676696777344, "mode": "train", "epoch": 7}
{"loss": 0.4394197165966034, "acc": 0.8192440867424011, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.39685744047164917, "acc": 0.8205333352088928, "length": 3.984586000442505, "mode": "train", "epoch": 8}
{"loss": 0.43646010756492615, "acc": 0.8170102834701538, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.38202759623527527, "acc": 0.829290509223938, "length": 3.991741180419922, "mode": "train", "epoch": 9}
{"loss": 0.40701714158058167, "acc": 0.8324742913246155, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.36696699261665344, "acc": 0.838682234287262, "length": 3.9941234588623047, "mode": "train", "epoch": 10}
{"loss": 0.39794406294822693, "acc": 0.8276633024215698, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.35907021164894104, "acc": 0.8466553092002869, "length": 3.995105504989624, "mode": "train", "epoch": 11}
{"loss": 0.397685170173645, "acc": 0.8281786441802979, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.3506241738796234, "acc": 0.8477652072906494, "length": 3.996446371078491, "mode": "train", "epoch": 12}
{"loss": 0.38885170221328735, "acc": 0.8335051536560059, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.3458057940006256, "acc": 0.8528853058815002, "length": 3.9965145587921143, "mode": "train", "epoch": 13}
{"loss": 0.3832297623157501, "acc": 0.8371134996414185, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.334401935338974, "acc": 0.8542274236679077, "length": 3.9974637031555176, "mode": "train", "epoch": 14}
{"loss": 0.37251561880111694, "acc": 0.8472508192062378, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.3255133032798767, "acc": 0.8605555891990662, "length": 3.9977450370788574, "mode": "train", "epoch": 15}
{"loss": 0.34437817335128784, "acc": 0.8615118861198425, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.3026851713657379, "acc": 0.8707961440086365, "length": 3.998002290725708, "mode": "train", "epoch": 16}
{"loss": 0.32958507537841797, "acc": 0.8568728566169739, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2807603180408478, "acc": 0.8797190189361572, "length": 3.9979469776153564, "mode": "train", "epoch": 17}
{"loss": 0.31604814529418945, "acc": 0.8599656224250793, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.271804541349411, "acc": 0.8873195648193359, "length": 3.9982988834381104, "mode": "train", "epoch": 18}
{"loss": 0.31548938155174255, "acc": 0.8670102953910828, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.27011391520500183, "acc": 0.8889320492744446, "length": 3.9983692169189453, "mode": "train", "epoch": 19}
{"loss": 0.30418670177459717, "acc": 0.8761168718338013, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.255191832780838, "acc": 0.8958882689476013, "length": 3.9984779357910156, "mode": "train", "epoch": 20}
{"loss": 0.29845181107521057, "acc": 0.8675258755683899, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.24688036739826202, "acc": 0.897737443447113, "length": 3.998735189437866, "mode": "train", "epoch": 21}
{"loss": 0.2835063934326172, "acc": 0.8778351545333862, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.24173130095005035, "acc": 0.901817262172699, "length": 3.9988253116607666, "mode": "train", "epoch": 22}
{"loss": 0.2773463726043701, "acc": 0.8826460838317871, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.24333107471466064, "acc": 0.9034311175346375, "length": 3.9989418983459473, "mode": "train", "epoch": 23}
{"loss": 0.26508599519729614, "acc": 0.8931272029876709, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.23220662772655487, "acc": 0.9075172543525696, "length": 3.9990291595458984, "mode": "train", "epoch": 24}
{"loss": 0.26119688153266907, "acc": 0.8907216787338257, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.2270546853542328, "acc": 0.9091903567314148, "length": 3.9991252422332764, "mode": "train", "epoch": 25}
{"loss": 0.2608954906463623, "acc": 0.900343656539917, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.22681023180484772, "acc": 0.9117793440818787, "length": 3.999263048171997, "mode": "train", "epoch": 26}
{"loss": 0.2531927525997162, "acc": 0.9020618796348572, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.21980084478855133, "acc": 0.9148048162460327, "length": 3.9985175132751465, "mode": "train", "epoch": 27}
{"loss": 0.24274294078350067, "acc": 0.910309374332428, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.22157205641269684, "acc": 0.9164357781410217, "length": 3.999215841293335, "mode": "train", "epoch": 28}
{"loss": 0.24759617447853088, "acc": 0.9135739803314209, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.21707184612751007, "acc": 0.9157556295394897, "length": 3.9995954036712646, "mode": "train", "epoch": 29}
{"loss": 0.24257425963878632, "acc": 0.897250771522522, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.20544575154781342, "acc": 0.9181127548217773, "length": 3.9995970726013184, "mode": "train", "epoch": 30}
{"loss": 0.22242271900177002, "acc": 0.9175258874893188, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.20654256641864777, "acc": 0.9190932512283325, "length": 3.9996449947357178, "mode": "train", "epoch": 31}
{"loss": 0.222128227353096, "acc": 0.9142611026763916, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.20096507668495178, "acc": 0.9215073585510254, "length": 3.999534845352173, "mode": "train", "epoch": 32}
{"loss": 0.21908526122570038, "acc": 0.9152922034263611, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.1996421068906784, "acc": 0.923064112663269, "length": 3.99971342086792, "mode": "train", "epoch": 33}
{"loss": 0.2167152464389801, "acc": 0.9180412292480469, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.19569173455238342, "acc": 0.9219678640365601, "length": 3.9995765686035156, "mode": "train", "epoch": 34}
{"loss": 0.21906839311122894, "acc": 0.916666567325592, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.19454798102378845, "acc": 0.9270814061164856, "length": 3.999541997909546, "mode": "train", "epoch": 35}
{"loss": 0.19748666882514954, "acc": 0.9235396385192871, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.18202002346515656, "acc": 0.9325598478317261, "length": 3.9998490810394287, "mode": "train", "epoch": 36}
{"loss": 0.1996009796857834, "acc": 0.922336757183075, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1711665689945221, "acc": 0.935664713382721, "length": 3.999833345413208, "mode": "train", "epoch": 37}
{"loss": 0.20734457671642303, "acc": 0.9292097091674805, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.16614781320095062, "acc": 0.9359535574913025, "length": 3.9998226165771484, "mode": "train", "epoch": 38}
{"loss": 0.19383497536182404, "acc": 0.9262886047363281, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.15812022984027863, "acc": 0.9407253861427307, "length": 3.999774217605591, "mode": "train", "epoch": 39}
{"loss": 0.1973414421081543, "acc": 0.9286942481994629, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.15654850006103516, "acc": 0.9408425092697144, "length": 3.9998183250427246, "mode": "train", "epoch": 40}
{"loss": 0.18023888766765594, "acc": 0.9364261031150818, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.14881359040737152, "acc": 0.9461395144462585, "length": 3.999903440475464, "mode": "train", "epoch": 41}
{"loss": 0.20391713082790375, "acc": 0.9286940693855286, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.1472739577293396, "acc": 0.9427440166473389, "length": 3.9998791217803955, "mode": "train", "epoch": 42}
{"loss": 0.17276762425899506, "acc": 0.9393469095230103, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.14188030362129211, "acc": 0.9456203579902649, "length": 3.9998843669891357, "mode": "train", "epoch": 43}
{"loss": 0.18693672120571136, "acc": 0.9317870140075684, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.14101390540599823, "acc": 0.9461382627487183, "length": 3.99989652633667, "mode": "train", "epoch": 44}
{"loss": 0.20173512399196625, "acc": 0.9261168241500854, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.13869687914848328, "acc": 0.9451627135276794, "length": 3.999918222427368, "mode": "train", "epoch": 45}
{"loss": 0.21454916894435883, "acc": 0.9304123520851135, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.13320587575435638, "acc": 0.9473916888237, "length": 3.9996821880340576, "mode": "train", "epoch": 46}
{"loss": 0.17462995648384094, "acc": 0.93865966796875, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1281416267156601, "acc": 0.9539663791656494, "length": 3.99993896484375, "mode": "train", "epoch": 47}
{"loss": 0.18137966096401215, "acc": 0.9391753077507019, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.12654663622379303, "acc": 0.951890766620636, "length": 3.9998881816864014, "mode": "train", "epoch": 48}
{"loss": 0.190538689494133, "acc": 0.9412370920181274, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.1313818097114563, "acc": 0.9493656754493713, "length": 3.9999752044677734, "mode": "train", "epoch": 49}
{"loss": 0.1897846907377243, "acc": 0.9396906495094299, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.13169090449810028, "acc": 0.9490209817886353, "length": 3.999983072280884, "mode": "train", "epoch": 50}
{"loss": 0.18633301556110382, "acc": 0.9305842518806458, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.12865056097507477, "acc": 0.9508618116378784, "length": 3.999974489212036, "mode": "train", "epoch": 51}
{"loss": 0.18190796673297882, "acc": 0.9374572038650513, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.12366879731416702, "acc": 0.953622579574585, "length": 3.9999585151672363, "mode": "train", "epoch": 52}
{"loss": 0.16347108781337738, "acc": 0.9494844675064087, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.12113191187381744, "acc": 0.9562671780586243, "length": 3.9999380111694336, "mode": "train", "epoch": 53}
{"loss": 0.15156035125255585, "acc": 0.9407216310501099, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.12126988172531128, "acc": 0.9526446461677551, "length": 3.9999618530273438, "mode": "train", "epoch": 54}
{"loss": 0.1838475465774536, "acc": 0.947079062461853, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.11485197395086288, "acc": 0.956328272819519, "length": 3.999986410140991, "mode": "train", "epoch": 55}
{"loss": 0.18915057182312012, "acc": 0.9477663636207581, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.10809211432933807, "acc": 0.9575927257537842, "length": 3.999964714050293, "mode": "train", "epoch": 56}
{"loss": 0.15457816421985626, "acc": 0.9498282670974731, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.11029116064310074, "acc": 0.9556950330734253, "length": 3.999979019165039, "mode": "train", "epoch": 57}
{"loss": 0.17776642739772797, "acc": 0.9460482001304626, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.11033210158348083, "acc": 0.9566161036491394, "length": 3.9999868869781494, "mode": "train", "epoch": 58}
{"loss": 0.16592909395694733, "acc": 0.9448453187942505, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.11497767269611359, "acc": 0.956960916519165, "length": 3.9999778270721436, "mode": "train", "epoch": 59}
{"loss": 0.16913099586963654, "acc": 0.9487972855567932, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.11555451899766922, "acc": 0.9558616876602173, "length": 3.9999208450317383, "mode": "train", "epoch": 60}
{"loss": 0.16348469257354736, "acc": 0.9457042813301086, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7828570604324341
