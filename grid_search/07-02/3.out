# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.99", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7004733085632324, "acc": 0.5284941792488098, "length": 2.8299038410186768, "mode": "train", "epoch": 1}
{"loss": 0.6908708810806274, "acc": 0.5311189889907837, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6566702127456665, "acc": 0.6031160950660706, "length": 2.352250099182129, "mode": "train", "epoch": 2}
{"loss": 0.5767557621002197, "acc": 0.7400418519973755, "length": 2.64685320854187, "mode": "test", "epoch": 2}
{"loss": 0.49355024099349976, "acc": 0.7853855490684509, "length": 3.1633381843566895, "mode": "train", "epoch": 3}
{"loss": 0.42364034056663513, "acc": 0.8240483403205872, "length": 3.4440560340881348, "mode": "test", "epoch": 3}
{"loss": 0.3867298662662506, "acc": 0.8386518359184265, "length": 3.5097224712371826, "mode": "train", "epoch": 4}
{"loss": 0.4248140752315521, "acc": 0.8290789127349854, "length": 3.332167863845825, "mode": "test", "epoch": 4}
{"loss": 0.35926568508148193, "acc": 0.8478991985321045, "length": 3.453620672225952, "mode": "train", "epoch": 5}
{"loss": 0.4057309925556183, "acc": 0.8398109674453735, "length": 3.3426573276519775, "mode": "test", "epoch": 5}
{"loss": 0.3435319662094116, "acc": 0.861958920955658, "length": 3.50180983543396, "mode": "train", "epoch": 6}
{"loss": 0.3785214424133301, "acc": 0.8457226157188416, "length": 3.468531370162964, "mode": "test", "epoch": 6}
{"loss": 0.32248446345329285, "acc": 0.8654447197914124, "length": 3.546577215194702, "mode": "train", "epoch": 7}
{"loss": 0.3812341094017029, "acc": 0.8335273861885071, "length": 3.639860153198242, "mode": "test", "epoch": 7}
{"loss": 0.3118911385536194, "acc": 0.8690301775932312, "length": 3.6399576663970947, "mode": "train", "epoch": 8}
{"loss": 0.35017478466033936, "acc": 0.8579468727111816, "length": 3.716783285140991, "mode": "test", "epoch": 8}
{"loss": 0.30083781480789185, "acc": 0.8739156126976013, "length": 3.7413859367370605, "mode": "train", "epoch": 9}
{"loss": 0.3402670919895172, "acc": 0.8593838214874268, "length": 3.7867133617401123, "mode": "test", "epoch": 9}
{"loss": 0.2840835154056549, "acc": 0.8830225467681885, "length": 3.7788922786712646, "mode": "train", "epoch": 10}
{"loss": 0.3200409412384033, "acc": 0.8755499720573425, "length": 3.8811187744140625, "mode": "test", "epoch": 10}
{"loss": 0.26313990354537964, "acc": 0.8971689343452454, "length": 3.848721981048584, "mode": "train", "epoch": 11}
{"loss": 0.3291632831096649, "acc": 0.875087320804596, "length": 3.968531370162964, "mode": "test", "epoch": 11}
{"loss": 0.2510610818862915, "acc": 0.9025201201438904, "length": 3.8804216384887695, "mode": "train", "epoch": 12}
{"loss": 0.3014526963233948, "acc": 0.8840909004211426, "length": 3.9965035915374756, "mode": "test", "epoch": 12}
{"loss": 0.2409374713897705, "acc": 0.9070639610290527, "length": 3.8774945735931396, "mode": "train", "epoch": 13}
{"loss": 0.31123581528663635, "acc": 0.8879101276397705, "length": 3.9720280170440674, "mode": "test", "epoch": 13}
{"loss": 0.23135121166706085, "acc": 0.9107720255851746, "length": 3.9089112281799316, "mode": "train", "epoch": 14}
{"loss": 0.3060300350189209, "acc": 0.8851398825645447, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.21644115447998047, "acc": 0.9188677668571472, "length": 3.8962512016296387, "mode": "train", "epoch": 15}
{"loss": 0.29657235741615295, "acc": 0.8907343149185181, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.21592751145362854, "acc": 0.9194968342781067, "length": 3.932871103286743, "mode": "train", "epoch": 16}
{"loss": 0.2783186733722687, "acc": 0.8930069804191589, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.20831076800823212, "acc": 0.9228473901748657, "length": 3.9122369289398193, "mode": "train", "epoch": 17}
{"loss": 0.2599937617778778, "acc": 0.9032084941864014, "length": 3.986013889312744, "mode": "test", "epoch": 17}
{"loss": 0.1949673593044281, "acc": 0.9250287413597107, "length": 3.910066843032837, "mode": "train", "epoch": 18}
{"loss": 0.2458009421825409, "acc": 0.9116824269294739, "length": 3.986013889312744, "mode": "test", "epoch": 18}
{"loss": 0.1848483830690384, "acc": 0.9312878251075745, "length": 3.937570571899414, "mode": "train", "epoch": 19}
{"loss": 0.26773297786712646, "acc": 0.9015733599662781, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.17851078510284424, "acc": 0.9311984181404114, "length": 3.913241386413574, "mode": "train", "epoch": 20}
{"loss": 0.26242151856422424, "acc": 0.9044966101646423, "length": 3.954545497894287, "mode": "test", "epoch": 20}
{"loss": 0.17142072319984436, "acc": 0.9339717626571655, "length": 3.88910174369812, "mode": "train", "epoch": 21}
{"loss": 0.2116742581129074, "acc": 0.9147493839263916, "length": 3.9895105361938477, "mode": "test", "epoch": 21}
{"loss": 0.15553018450737, "acc": 0.9413522481918335, "length": 3.9262139797210693, "mode": "train", "epoch": 22}
{"loss": 0.21667920053005219, "acc": 0.9185041785240173, "length": 3.9965035915374756, "mode": "test", "epoch": 22}
{"loss": 0.14455898106098175, "acc": 0.94476318359375, "length": 3.9429843425750732, "mode": "train", "epoch": 23}
{"loss": 0.20312446355819702, "acc": 0.9316434264183044, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.13251182436943054, "acc": 0.9495261907577515, "length": 3.9612436294555664, "mode": "train", "epoch": 24}
{"loss": 0.1915265917778015, "acc": 0.9251750707626343, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.12469926476478577, "acc": 0.9511668682098389, "length": 3.9803240299224854, "mode": "train", "epoch": 25}
{"loss": 0.2142341434955597, "acc": 0.9234266877174377, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.1134430468082428, "acc": 0.9538343548774719, "length": 3.98075008392334, "mode": "train", "epoch": 26}
{"loss": 0.16344773769378662, "acc": 0.9382866024971008, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.09064324200153351, "acc": 0.9669210910797119, "length": 3.9759597778320312, "mode": "train", "epoch": 27}
{"loss": 0.16933822631835938, "acc": 0.936538577079773, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.08339750021696091, "acc": 0.9673712849617004, "length": 3.9848930835723877, "mode": "train", "epoch": 28}
{"loss": 0.16621823608875275, "acc": 0.9445804953575134, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.07212469726800919, "acc": 0.9734269976615906, "length": 3.986477851867676, "mode": "train", "epoch": 29}
{"loss": 0.14395226538181305, "acc": 0.9501748085021973, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.07169567048549652, "acc": 0.9720524549484253, "length": 3.9893808364868164, "mode": "train", "epoch": 30}
{"loss": 0.1400415599346161, "acc": 0.9503496885299683, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.0778467208147049, "acc": 0.971725583076477, "length": 3.9967963695526123, "mode": "train", "epoch": 31}
{"loss": 0.12771739065647125, "acc": 0.955069899559021, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.06293629109859467, "acc": 0.9776462912559509, "length": 3.993722438812256, "mode": "train", "epoch": 32}
{"loss": 0.11332757025957108, "acc": 0.9617133736610413, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.050393231213092804, "acc": 0.9816949367523193, "length": 3.995502233505249, "mode": "train", "epoch": 33}
{"loss": 0.107692651450634, "acc": 0.9618881344795227, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.05347553640604019, "acc": 0.9798372983932495, "length": 3.9953019618988037, "mode": "train", "epoch": 34}
{"loss": 0.06883178651332855, "acc": 0.9725522994995117, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.044892147183418274, "acc": 0.9852468371391296, "length": 3.995974540710449, "mode": "train", "epoch": 35}
{"loss": 0.1292608082294464, "acc": 0.9667832255363464, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.05565895140171051, "acc": 0.9773263931274414, "length": 3.9969594478607178, "mode": "train", "epoch": 36}
{"loss": 0.11293468624353409, "acc": 0.9618881344795227, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.04417308792471886, "acc": 0.9837570786476135, "length": 3.9981257915496826, "mode": "train", "epoch": 37}
{"loss": 0.06228402629494667, "acc": 0.977097749710083, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.04205453023314476, "acc": 0.9835297465324402, "length": 3.9984824657440186, "mode": "train", "epoch": 38}
{"loss": 0.0639297291636467, "acc": 0.9821678996086121, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.030023276805877686, "acc": 0.9905085563659668, "length": 3.996659278869629, "mode": "train", "epoch": 39}
{"loss": 0.07130171358585358, "acc": 0.9756991267204285, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.04954434931278229, "acc": 0.9831011891365051, "length": 3.997814178466797, "mode": "train", "epoch": 40}
{"loss": 0.13252539932727814, "acc": 0.9622377157211304, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.045004960149526596, "acc": 0.9849236607551575, "length": 3.9989564418792725, "mode": "train", "epoch": 41}
{"loss": 0.08480244129896164, "acc": 0.9718533158302307, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.03134560212492943, "acc": 0.9890872836112976, "length": 3.9987633228302, "mode": "train", "epoch": 42}
{"loss": 0.08655202388763428, "acc": 0.9751747846603394, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.02690395712852478, "acc": 0.9900920987129211, "length": 3.999404191970825, "mode": "train", "epoch": 43}
{"loss": 0.06531796604394913, "acc": 0.975874125957489, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.0246258731931448, "acc": 0.991536557674408, "length": 3.99880051612854, "mode": "train", "epoch": 44}
{"loss": 0.05622087046504021, "acc": 0.9807692170143127, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.020773446187376976, "acc": 0.9938351511955261, "length": 3.9990410804748535, "mode": "train", "epoch": 45}
{"loss": 0.057235732674598694, "acc": 0.9781468510627747, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.02726677432656288, "acc": 0.9899085164070129, "length": 3.998582601547241, "mode": "train", "epoch": 46}
{"loss": 0.04707090184092522, "acc": 0.9833915829658508, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.02446444146335125, "acc": 0.9926761984825134, "length": 3.9959323406219482, "mode": "train", "epoch": 47}
{"loss": 0.0907980352640152, "acc": 0.9737762212753296, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.054960716515779495, "acc": 0.9830103516578674, "length": 3.9993398189544678, "mode": "train", "epoch": 48}
{"loss": 0.15763190388679504, "acc": 0.9627622365951538, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.050139956176280975, "acc": 0.9844130873680115, "length": 3.999141216278076, "mode": "train", "epoch": 49}
{"loss": 0.11878359317779541, "acc": 0.9620628356933594, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.04139264300465584, "acc": 0.9872763752937317, "length": 3.9988808631896973, "mode": "train", "epoch": 50}
{"loss": 0.08792196214199066, "acc": 0.9797202348709106, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.030939793214201927, "acc": 0.9910913109779358, "length": 3.9995710849761963, "mode": "train", "epoch": 51}
{"loss": 0.058101728558540344, "acc": 0.9863636493682861, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.021331245079636574, "acc": 0.9943123459815979, "length": 3.9995782375335693, "mode": "train", "epoch": 52}
{"loss": 0.04996620491147041, "acc": 0.9879371523857117, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.016433650627732277, "acc": 0.9965867400169373, "length": 3.9992949962615967, "mode": "train", "epoch": 53}
{"loss": 0.05518080294132233, "acc": 0.9914335012435913, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.01946275308728218, "acc": 0.9936670064926147, "length": 3.9992520809173584, "mode": "train", "epoch": 54}
{"loss": 0.060545749962329865, "acc": 0.9849650859832764, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.019746217876672745, "acc": 0.9941388964653015, "length": 3.9996564388275146, "mode": "train", "epoch": 55}
{"loss": 0.06956688314676285, "acc": 0.9804195761680603, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.018454553559422493, "acc": 0.9953426718711853, "length": 3.998871088027954, "mode": "train", "epoch": 56}
{"loss": 0.06121798977255821, "acc": 0.9828670620918274, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.021590884774923325, "acc": 0.9931429624557495, "length": 3.9996871948242188, "mode": "train", "epoch": 57}
{"loss": 0.06612477451562881, "acc": 0.9835665225982666, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.026015158742666245, "acc": 0.9928506016731262, "length": 3.9997103214263916, "mode": "train", "epoch": 58}
{"loss": 0.07187647372484207, "acc": 0.9826923608779907, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.02454250678420067, "acc": 0.9923837780952454, "length": 3.9997713565826416, "mode": "train", "epoch": 59}
{"loss": 0.0490032322704792, "acc": 0.9865383505821228, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.03198005259037018, "acc": 0.9914425015449524, "length": 3.9995357990264893, "mode": "train", "epoch": 60}
{"loss": 0.08449964225292206, "acc": 0.9791956543922424, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.9043332934379578
