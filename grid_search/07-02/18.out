# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7005416750907898, "acc": 0.5052540898323059, "length": 3.5058493614196777, "mode": "train", "epoch": 1}
{"loss": 0.6958433389663696, "acc": 0.4959459602832794, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6944984197616577, "acc": 0.5204039812088013, "length": 3.2785329818725586, "mode": "train", "epoch": 2}
{"loss": 0.6919714212417603, "acc": 0.5072635412216187, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6882269978523254, "acc": 0.547157883644104, "length": 2.942805290222168, "mode": "train", "epoch": 3}
{"loss": 0.6955947279930115, "acc": 0.5052365064620972, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6752901673316956, "acc": 0.5858395099639893, "length": 2.815903663635254, "mode": "train", "epoch": 4}
{"loss": 0.6398839354515076, "acc": 0.6615083813667297, "length": 3.1148648262023926, "mode": "test", "epoch": 4}
{"loss": 0.63437819480896, "acc": 0.6636813879013062, "length": 3.3345954418182373, "mode": "train", "epoch": 5}
{"loss": 0.5955207943916321, "acc": 0.7315477132797241, "length": 3.797297239303589, "mode": "test", "epoch": 5}
{"loss": 0.5749832391738892, "acc": 0.720645546913147, "length": 3.5927648544311523, "mode": "train", "epoch": 6}
{"loss": 0.5563888549804688, "acc": 0.7439218163490295, "length": 3.7060811519622803, "mode": "test", "epoch": 6}
{"loss": 0.5278297662734985, "acc": 0.7607014775276184, "length": 3.553062915802002, "mode": "train", "epoch": 7}
{"loss": 0.532479465007782, "acc": 0.7746431231498718, "length": 3.4662163257598877, "mode": "test", "epoch": 7}
{"loss": 0.489338219165802, "acc": 0.7883960604667664, "length": 3.374422788619995, "mode": "train", "epoch": 8}
{"loss": 0.5031136870384216, "acc": 0.7814513444900513, "length": 3.4391891956329346, "mode": "test", "epoch": 8}
{"loss": 0.4498645067214966, "acc": 0.8026508092880249, "length": 3.372624158859253, "mode": "train", "epoch": 9}
{"loss": 0.43922901153564453, "acc": 0.7983208298683167, "length": 3.4695944786071777, "mode": "test", "epoch": 9}
{"loss": 0.41322949528694153, "acc": 0.8245044350624084, "length": 3.4448282718658447, "mode": "train", "epoch": 10}
{"loss": 0.40651935338974, "acc": 0.8140960931777954, "length": 3.75, "mode": "test", "epoch": 10}
{"loss": 0.38443848490715027, "acc": 0.8390696048736572, "length": 3.6909732818603516, "mode": "train", "epoch": 11}
{"loss": 0.38465243577957153, "acc": 0.8222972750663757, "length": 3.8074324131011963, "mode": "test", "epoch": 11}
{"loss": 0.3584783971309662, "acc": 0.849989116191864, "length": 3.6936559677124023, "mode": "train", "epoch": 12}
{"loss": 0.3510359525680542, "acc": 0.8417876362800598, "length": 3.753378391265869, "mode": "test", "epoch": 12}
{"loss": 0.3312203586101532, "acc": 0.86693274974823, "length": 3.7310895919799805, "mode": "train", "epoch": 13}
{"loss": 0.3509708344936371, "acc": 0.8563138842582703, "length": 3.824324369430542, "mode": "test", "epoch": 13}
{"loss": 0.30534738302230835, "acc": 0.8756272196769714, "length": 3.755995035171509, "mode": "train", "epoch": 14}
{"loss": 0.3059212863445282, "acc": 0.8639033436775208, "length": 3.898648738861084, "mode": "test", "epoch": 14}
{"loss": 0.2793143391609192, "acc": 0.8896005153656006, "length": 3.8348944187164307, "mode": "train", "epoch": 15}
{"loss": 0.316163033246994, "acc": 0.8704732060432434, "length": 3.972972869873047, "mode": "test", "epoch": 15}
{"loss": 0.2605268955230713, "acc": 0.8961454629898071, "length": 3.9017539024353027, "mode": "train", "epoch": 16}
{"loss": 0.28875091671943665, "acc": 0.8758445978164673, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.24732369184494019, "acc": 0.9036519527435303, "length": 3.9440653324127197, "mode": "train", "epoch": 17}
{"loss": 0.27591270208358765, "acc": 0.8851351141929626, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.23349393904209137, "acc": 0.9102380871772766, "length": 3.975586414337158, "mode": "train", "epoch": 18}
{"loss": 0.25932741165161133, "acc": 0.9027026295661926, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.22266098856925964, "acc": 0.9157785177230835, "length": 3.983273506164551, "mode": "train", "epoch": 19}
{"loss": 0.2596680819988251, "acc": 0.898648738861084, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.21834474802017212, "acc": 0.9205999374389648, "length": 3.9925694465637207, "mode": "train", "epoch": 20}
{"loss": 0.25228577852249146, "acc": 0.901520311832428, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.20513421297073364, "acc": 0.9238542318344116, "length": 3.9924240112304688, "mode": "train", "epoch": 21}
{"loss": 0.21632486581802368, "acc": 0.9114865660667419, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.194692924618721, "acc": 0.9297300577163696, "length": 3.9949588775634766, "mode": "train", "epoch": 22}
{"loss": 0.21935757994651794, "acc": 0.9184120893478394, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.19391408562660217, "acc": 0.9300433397293091, "length": 3.990089178085327, "mode": "train", "epoch": 23}
{"loss": 0.20875756442546844, "acc": 0.9222971796989441, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.18436019122600555, "acc": 0.9327641129493713, "length": 3.9950997829437256, "mode": "train", "epoch": 24}
{"loss": 0.20695683360099792, "acc": 0.9275338649749756, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.1874290257692337, "acc": 0.928930938243866, "length": 3.9946281909942627, "mode": "train", "epoch": 25}
{"loss": 0.19489745795726776, "acc": 0.9309121966362, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.18193180859088898, "acc": 0.9308363795280457, "length": 3.9950485229492188, "mode": "train", "epoch": 26}
{"loss": 0.20841102302074432, "acc": 0.9260137677192688, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1711999922990799, "acc": 0.9364832639694214, "length": 3.9932684898376465, "mode": "train", "epoch": 27}
{"loss": 0.18866483867168427, "acc": 0.9290541410446167, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.16910316050052643, "acc": 0.9365223050117493, "length": 3.994826078414917, "mode": "train", "epoch": 28}
{"loss": 0.18337807059288025, "acc": 0.9346283674240112, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.16090431809425354, "acc": 0.9402124881744385, "length": 3.9963629245758057, "mode": "train", "epoch": 29}
{"loss": 0.18783801794052124, "acc": 0.9288849830627441, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.1672779768705368, "acc": 0.939833402633667, "length": 3.9974377155303955, "mode": "train", "epoch": 30}
{"loss": 0.18705090880393982, "acc": 0.9332770109176636, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.15747639536857605, "acc": 0.9433245658874512, "length": 3.996800661087036, "mode": "train", "epoch": 31}
{"loss": 0.18680785596370697, "acc": 0.9349662065505981, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.15937243402004242, "acc": 0.9467959403991699, "length": 3.9954628944396973, "mode": "train", "epoch": 32}
{"loss": 0.17553427815437317, "acc": 0.9432432055473328, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.15322564542293549, "acc": 0.9440909624099731, "length": 3.9980435371398926, "mode": "train", "epoch": 33}
{"loss": 0.1696143001317978, "acc": 0.9403718709945679, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.1552373766899109, "acc": 0.9479050636291504, "length": 3.9961097240448, "mode": "train", "epoch": 34}
{"loss": 0.16808709502220154, "acc": 0.9457769393920898, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.14753933250904083, "acc": 0.9448306560516357, "length": 3.9978625774383545, "mode": "train", "epoch": 35}
{"loss": 0.15985332429409027, "acc": 0.949155330657959, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.13667015731334686, "acc": 0.9485164880752563, "length": 3.9983901977539062, "mode": "train", "epoch": 36}
{"loss": 0.1415681093931198, "acc": 0.9498310685157776, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1379995346069336, "acc": 0.9481006264686584, "length": 3.9974679946899414, "mode": "train", "epoch": 37}
{"loss": 0.12950557470321655, "acc": 0.9554054737091064, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.14127016067504883, "acc": 0.9456762671470642, "length": 3.9962635040283203, "mode": "train", "epoch": 38}
{"loss": 0.152206689119339, "acc": 0.9444257616996765, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.13077394664287567, "acc": 0.9479599595069885, "length": 3.9993438720703125, "mode": "train", "epoch": 39}
{"loss": 0.1387970745563507, "acc": 0.9474661350250244, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.12866799533367157, "acc": 0.9515880942344666, "length": 3.996488571166992, "mode": "train", "epoch": 40}
{"loss": 0.13565360009670258, "acc": 0.9552366137504578, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.12008465826511383, "acc": 0.9569666385650635, "length": 3.996645450592041, "mode": "train", "epoch": 41}
{"loss": 0.12305846810340881, "acc": 0.9557431936264038, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.11725635081529617, "acc": 0.957107424736023, "length": 3.994342803955078, "mode": "train", "epoch": 42}
{"loss": 0.12061980366706848, "acc": 0.9636825323104858, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.11471711099147797, "acc": 0.9561147689819336, "length": 3.9969482421875, "mode": "train", "epoch": 43}
{"loss": 0.11743402481079102, "acc": 0.9618241786956787, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.10936904698610306, "acc": 0.9623786211013794, "length": 3.999466896057129, "mode": "train", "epoch": 44}
{"loss": 0.11993525922298431, "acc": 0.9638513922691345, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.10907776653766632, "acc": 0.9592054486274719, "length": 3.9958221912384033, "mode": "train", "epoch": 45}
{"loss": 0.11390773952007294, "acc": 0.9663851857185364, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.11008046567440033, "acc": 0.9613615870475769, "length": 3.999516248703003, "mode": "train", "epoch": 46}
{"loss": 0.10906606167554855, "acc": 0.9657095074653625, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.10535840690135956, "acc": 0.9635156989097595, "length": 3.9997785091400146, "mode": "train", "epoch": 47}
{"loss": 0.11350490152835846, "acc": 0.9596284627914429, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.0942155048251152, "acc": 0.9676937460899353, "length": 3.9994757175445557, "mode": "train", "epoch": 48}
{"loss": 0.10925941169261932, "acc": 0.9711148142814636, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.09471908211708069, "acc": 0.964630126953125, "length": 3.9992287158966064, "mode": "train", "epoch": 49}
{"loss": 0.10572805255651474, "acc": 0.9695944786071777, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.09021903574466705, "acc": 0.9660989046096802, "length": 3.996260166168213, "mode": "train", "epoch": 50}
{"loss": 0.09688842296600342, "acc": 0.9711148142814636, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.09401498734951019, "acc": 0.9653721451759338, "length": 3.999253988265991, "mode": "train", "epoch": 51}
{"loss": 0.10654779523611069, "acc": 0.9689189791679382, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.0911162793636322, "acc": 0.968649685382843, "length": 3.998732089996338, "mode": "train", "epoch": 52}
{"loss": 0.10980446636676788, "acc": 0.9668918251991272, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.08271795511245728, "acc": 0.9706724882125854, "length": 3.9977898597717285, "mode": "train", "epoch": 53}
{"loss": 0.10657055675983429, "acc": 0.9711148142814636, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.07861200720071793, "acc": 0.972846508026123, "length": 3.999752998352051, "mode": "train", "epoch": 54}
{"loss": 0.10233710706233978, "acc": 0.9744932055473328, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.08405666798353195, "acc": 0.9721146821975708, "length": 3.999960422515869, "mode": "train", "epoch": 55}
{"loss": 0.09663069248199463, "acc": 0.9768580794334412, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.07916432619094849, "acc": 0.9719974994659424, "length": 3.9997365474700928, "mode": "train", "epoch": 56}
{"loss": 0.09453144669532776, "acc": 0.9748311638832092, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.0761612057685852, "acc": 0.9753919839859009, "length": 3.999789237976074, "mode": "train", "epoch": 57}
{"loss": 0.107357919216156, "acc": 0.9771959185600281, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.07965177297592163, "acc": 0.9708125591278076, "length": 3.9999001026153564, "mode": "train", "epoch": 58}
{"loss": 0.09162451326847076, "acc": 0.9768581986427307, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.07485643029212952, "acc": 0.9747707843780518, "length": 3.999819040298462, "mode": "train", "epoch": 59}
{"loss": 0.093012735247612, "acc": 0.9741553068161011, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.07598395645618439, "acc": 0.9736383557319641, "length": 3.9998016357421875, "mode": "train", "epoch": 60}
{"loss": 0.09064185619354248, "acc": 0.9743242859840393, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8367308974266052
