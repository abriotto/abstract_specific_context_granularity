# ["--attributes=5", "--values=16", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=128", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7007939219474792, "acc": 0.5046236515045166, "length": 3.4861600399017334, "mode": "train", "epoch": 1}
{"loss": 0.6924037933349609, "acc": 0.4920608401298523, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.696661114692688, "acc": 0.515845000743866, "length": 3.1708321571350098, "mode": "train", "epoch": 2}
{"loss": 0.6937525272369385, "acc": 0.5086149573326111, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6905232071876526, "acc": 0.5343412160873413, "length": 2.3957433700561523, "mode": "train", "epoch": 3}
{"loss": 0.6917755007743835, "acc": 0.5222972631454468, "length": 1.0, "mode": "test", "epoch": 3}
{"loss": 0.6835500001907349, "acc": 0.5744134783744812, "length": 2.4628779888153076, "mode": "train", "epoch": 4}
{"loss": 0.6667563915252686, "acc": 0.6194637417793274, "length": 2.104729652404785, "mode": "test", "epoch": 4}
{"loss": 0.6631611585617065, "acc": 0.6567578911781311, "length": 2.777374029159546, "mode": "train", "epoch": 5}
{"loss": 0.6460678577423096, "acc": 0.7110704779624939, "length": 2.3817567825317383, "mode": "test", "epoch": 5}
{"loss": 0.6216436624526978, "acc": 0.7172934412956238, "length": 3.051210641860962, "mode": "train", "epoch": 6}
{"loss": 0.5868468284606934, "acc": 0.7371209859848022, "length": 3.875, "mode": "test", "epoch": 6}
{"loss": 0.5475155711174011, "acc": 0.7635948061943054, "length": 3.5468318462371826, "mode": "train", "epoch": 7}
{"loss": 0.5491073727607727, "acc": 0.7288851141929626, "length": 4.0, "mode": "test", "epoch": 7}
{"loss": 0.48472943902015686, "acc": 0.7771053910255432, "length": 3.877495765686035, "mode": "train", "epoch": 8}
{"loss": 0.5503823757171631, "acc": 0.7266891598701477, "length": 4.0, "mode": "test", "epoch": 8}
{"loss": 0.46623197197914124, "acc": 0.7874142527580261, "length": 3.945586919784546, "mode": "train", "epoch": 9}
{"loss": 0.5457264184951782, "acc": 0.7395270466804504, "length": 4.0, "mode": "test", "epoch": 9}
{"loss": 0.44088873267173767, "acc": 0.7989698648452759, "length": 3.955902576446533, "mode": "train", "epoch": 10}
{"loss": 0.5277384519577026, "acc": 0.7690878510475159, "length": 4.0, "mode": "test", "epoch": 10}
{"loss": 0.4195348918437958, "acc": 0.8233682513237, "length": 3.960432529449463, "mode": "train", "epoch": 11}
{"loss": 0.4982098937034607, "acc": 0.7763512134552002, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.39584437012672424, "acc": 0.8297735452651978, "length": 3.9656314849853516, "mode": "train", "epoch": 12}
{"loss": 0.49385184049606323, "acc": 0.7815877795219421, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.36991026997566223, "acc": 0.8400484919548035, "length": 3.9764492511749268, "mode": "train", "epoch": 13}
{"loss": 0.49081945419311523, "acc": 0.7962837219238281, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.3461920917034149, "acc": 0.8628144860267639, "length": 3.981966733932495, "mode": "train", "epoch": 14}
{"loss": 0.45664533972740173, "acc": 0.8067567944526672, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.32291561365127563, "acc": 0.8688803315162659, "length": 3.9858784675598145, "mode": "train", "epoch": 15}
{"loss": 0.4280214011669159, "acc": 0.831925630569458, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.30333343148231506, "acc": 0.8840292692184448, "length": 3.9907336235046387, "mode": "train", "epoch": 16}
{"loss": 0.4113866090774536, "acc": 0.8429053425788879, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.2879369258880615, "acc": 0.8874205350875854, "length": 3.9908969402313232, "mode": "train", "epoch": 17}
{"loss": 0.39883801341056824, "acc": 0.8402026295661926, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.2767966389656067, "acc": 0.8917160630226135, "length": 3.9952597618103027, "mode": "train", "epoch": 18}
{"loss": 0.3900461792945862, "acc": 0.8422296047210693, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.269846647977829, "acc": 0.8932995200157166, "length": 3.99267578125, "mode": "train", "epoch": 19}
{"loss": 0.39416807889938354, "acc": 0.84375, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.26392340660095215, "acc": 0.8986884355545044, "length": 3.9940061569213867, "mode": "train", "epoch": 20}
{"loss": 0.3651493489742279, "acc": 0.8545606732368469, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.25429561734199524, "acc": 0.9030591249465942, "length": 3.994995594024658, "mode": "train", "epoch": 21}
{"loss": 0.3530440330505371, "acc": 0.8599663376808167, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.2505258321762085, "acc": 0.9059305787086487, "length": 3.9968650341033936, "mode": "train", "epoch": 22}
{"loss": 0.3472937345504761, "acc": 0.866385281085968, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.2437727153301239, "acc": 0.9105210900306702, "length": 3.9978833198547363, "mode": "train", "epoch": 23}
{"loss": 0.33867835998535156, "acc": 0.880912184715271, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.23629799485206604, "acc": 0.9157522916793823, "length": 3.9988222122192383, "mode": "train", "epoch": 24}
{"loss": 0.3208507299423218, "acc": 0.8832769393920898, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.22849613428115845, "acc": 0.9193909168243408, "length": 3.997194290161133, "mode": "train", "epoch": 25}
{"loss": 0.3148382306098938, "acc": 0.8881756663322449, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.22590938210487366, "acc": 0.9235761165618896, "length": 3.999622106552124, "mode": "train", "epoch": 26}
{"loss": 0.31156307458877563, "acc": 0.8907095193862915, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.2227933555841446, "acc": 0.9233272671699524, "length": 3.9990181922912598, "mode": "train", "epoch": 27}
{"loss": 0.3067731261253357, "acc": 0.8952702879905701, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.2157154381275177, "acc": 0.9267412424087524, "length": 3.9995784759521484, "mode": "train", "epoch": 28}
{"loss": 0.3047902286052704, "acc": 0.8932433128356934, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.21221324801445007, "acc": 0.9267880320549011, "length": 3.999213457107544, "mode": "train", "epoch": 29}
{"loss": 0.3000091314315796, "acc": 0.902533769607544, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.20388756692409515, "acc": 0.930901825428009, "length": 3.9969239234924316, "mode": "train", "epoch": 30}
{"loss": 0.3035121262073517, "acc": 0.8964527249336243, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.20952633023262024, "acc": 0.9280469417572021, "length": 3.9995992183685303, "mode": "train", "epoch": 31}
{"loss": 0.29658621549606323, "acc": 0.9067565202713013, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.20446068048477173, "acc": 0.9317194819450378, "length": 3.999296188354492, "mode": "train", "epoch": 32}
{"loss": 0.29312995076179504, "acc": 0.8969593644142151, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.19693896174430847, "acc": 0.9325065016746521, "length": 3.9996488094329834, "mode": "train", "epoch": 33}
{"loss": 0.29643869400024414, "acc": 0.9116554260253906, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.20193056762218475, "acc": 0.9310482144355774, "length": 3.9997317790985107, "mode": "train", "epoch": 34}
{"loss": 0.3009392321109772, "acc": 0.9045608043670654, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.19687670469284058, "acc": 0.9348458647727966, "length": 3.9982941150665283, "mode": "train", "epoch": 35}
{"loss": 0.29718729853630066, "acc": 0.9114865660667419, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.20065149664878845, "acc": 0.9307647943496704, "length": 3.997889280319214, "mode": "train", "epoch": 36}
{"loss": 0.2882635295391083, "acc": 0.9089527726173401, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.1920541375875473, "acc": 0.9358018636703491, "length": 3.9999687671661377, "mode": "train", "epoch": 37}
{"loss": 0.29264944791793823, "acc": 0.9165540933609009, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.18978433310985565, "acc": 0.9389123916625977, "length": 3.9999332427978516, "mode": "train", "epoch": 38}
{"loss": 0.28448551893234253, "acc": 0.9119932055473328, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.19097772240638733, "acc": 0.9367634057998657, "length": 3.9999592304229736, "mode": "train", "epoch": 39}
{"loss": 0.28064537048339844, "acc": 0.9094594120979309, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.18920587003231049, "acc": 0.9374987483024597, "length": 3.9999594688415527, "mode": "train", "epoch": 40}
{"loss": 0.2808900475502014, "acc": 0.9211149215698242, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.1857641339302063, "acc": 0.941057562828064, "length": 3.999666690826416, "mode": "train", "epoch": 41}
{"loss": 0.2823934257030487, "acc": 0.9163851141929626, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.18621660768985748, "acc": 0.9388890862464905, "length": 3.999478578567505, "mode": "train", "epoch": 42}
{"loss": 0.2860147953033447, "acc": 0.9118242859840393, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.1838749200105667, "acc": 0.9401119351387024, "length": 3.998400926589966, "mode": "train", "epoch": 43}
{"loss": 0.2773151993751526, "acc": 0.9160472750663757, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.1822076290845871, "acc": 0.9407233595848083, "length": 3.9999749660491943, "mode": "train", "epoch": 44}
{"loss": 0.2754884958267212, "acc": 0.9168919920921326, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.17858415842056274, "acc": 0.9423631429672241, "length": 3.999967336654663, "mode": "train", "epoch": 45}
{"loss": 0.2953844666481018, "acc": 0.9150336980819702, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.17547176778316498, "acc": 0.9435659050941467, "length": 3.999023675918579, "mode": "train", "epoch": 46}
{"loss": 0.2607121467590332, "acc": 0.9233108758926392, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.1764144003391266, "acc": 0.9427592158317566, "length": 3.99997615814209, "mode": "train", "epoch": 47}
{"loss": 0.26671844720840454, "acc": 0.9197636246681213, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.17606158554553986, "acc": 0.9423579573631287, "length": 3.999802827835083, "mode": "train", "epoch": 48}
{"loss": 0.28227198123931885, "acc": 0.9163852334022522, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.17279604077339172, "acc": 0.9437185525894165, "length": 3.9998855590820312, "mode": "train", "epoch": 49}
{"loss": 0.2541291117668152, "acc": 0.9162161350250244, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.17108233273029327, "acc": 0.9445639252662659, "length": 3.9998481273651123, "mode": "train", "epoch": 50}
{"loss": 0.2568199336528778, "acc": 0.9182432889938354, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.17224101722240448, "acc": 0.9431551694869995, "length": 3.999962091445923, "mode": "train", "epoch": 51}
{"loss": 0.24963077902793884, "acc": 0.9195945262908936, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.16791599988937378, "acc": 0.9440605640411377, "length": 3.9999804496765137, "mode": "train", "epoch": 52}
{"loss": 0.2556074261665344, "acc": 0.9190878868103027, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.16690418124198914, "acc": 0.9447396397590637, "length": 3.999995470046997, "mode": "train", "epoch": 53}
{"loss": 0.25285327434539795, "acc": 0.9212837219238281, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.16318881511688232, "acc": 0.947001039981842, "length": 3.9999639987945557, "mode": "train", "epoch": 54}
{"loss": 0.24861383438110352, "acc": 0.9192568063735962, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.16172926127910614, "acc": 0.9455881118774414, "length": 3.999997138977051, "mode": "train", "epoch": 55}
{"loss": 0.24612554907798767, "acc": 0.9224662780761719, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.15996399521827698, "acc": 0.9478372931480408, "length": 3.9995946884155273, "mode": "train", "epoch": 56}
{"loss": 0.24736659228801727, "acc": 0.9212837219238281, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.1608017385005951, "acc": 0.945699155330658, "length": 3.9999279975891113, "mode": "train", "epoch": 57}
{"loss": 0.24550482630729675, "acc": 0.9168919920921326, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.15709742903709412, "acc": 0.9463230967521667, "length": 3.9999847412109375, "mode": "train", "epoch": 58}
{"loss": 0.2525005340576172, "acc": 0.9246621131896973, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.15901225805282593, "acc": 0.9457005858421326, "length": 3.9999842643737793, "mode": "train", "epoch": 59}
{"loss": 0.26168715953826904, "acc": 0.9229729175567627, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.1595129817724228, "acc": 0.9456995725631714, "length": 3.999906539916992, "mode": "train", "epoch": 60}
{"loss": 0.269290566444397, "acc": 0.9204391241073608, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.7928846478462219
