# ["--attributes=3", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=32", "--learning_rate=0.0005", "--hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7031458616256714, "acc": 0.5134660601615906, "length": 2.547942638397217, "mode": "train", "epoch": 1}
{"loss": 0.6928956508636475, "acc": 0.5224198698997498, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6663767099380493, "acc": 0.5891147255897522, "length": 1.9865835905075073, "mode": "train", "epoch": 2}
{"loss": 0.6143954396247864, "acc": 0.6849306225776672, "length": 2.338078260421753, "mode": "test", "epoch": 2}
{"loss": 0.5697768330574036, "acc": 0.7114230990409851, "length": 2.5771431922912598, "mode": "train", "epoch": 3}
{"loss": 0.5446117520332336, "acc": 0.742781400680542, "length": 2.846975088119507, "mode": "test", "epoch": 3}
{"loss": 0.4874018132686615, "acc": 0.7836307287216187, "length": 3.0935277938842773, "mode": "train", "epoch": 4}
{"loss": 0.5071205496788025, "acc": 0.7765718698501587, "length": 3.263345241546631, "mode": "test", "epoch": 4}
{"loss": 0.4374305009841919, "acc": 0.8082764148712158, "length": 3.226729154586792, "mode": "train", "epoch": 5}
{"loss": 0.45229169726371765, "acc": 0.8036867380142212, "length": 3.327402114868164, "mode": "test", "epoch": 5}
{"loss": 0.39954808354377747, "acc": 0.8348287343978882, "length": 3.304783582687378, "mode": "train", "epoch": 6}
{"loss": 0.4307391047477722, "acc": 0.8177328705787659, "length": 3.423487663269043, "mode": "test", "epoch": 6}
{"loss": 0.35246267914772034, "acc": 0.8521454930305481, "length": 3.46655535697937, "mode": "train", "epoch": 7}
{"loss": 0.4039498269557953, "acc": 0.8396449685096741, "length": 3.5622775554656982, "mode": "test", "epoch": 7}
{"loss": 0.31045612692832947, "acc": 0.8725217580795288, "length": 3.5093283653259277, "mode": "train", "epoch": 8}
{"loss": 0.3623916804790497, "acc": 0.8512427806854248, "length": 3.6903915405273438, "mode": "test", "epoch": 8}
{"loss": 0.2814401090145111, "acc": 0.8833698630332947, "length": 3.573413372039795, "mode": "train", "epoch": 9}
{"loss": 0.34163999557495117, "acc": 0.8656116127967834, "length": 3.8505337238311768, "mode": "test", "epoch": 9}
{"loss": 0.24943625926971436, "acc": 0.9018758535385132, "length": 3.647571563720703, "mode": "train", "epoch": 10}
{"loss": 0.3283759653568268, "acc": 0.8699397444725037, "length": 3.7117438316345215, "mode": "test", "epoch": 10}
{"loss": 0.23454998433589935, "acc": 0.9106574654579163, "length": 3.781273603439331, "mode": "train", "epoch": 11}
{"loss": 0.3072267472743988, "acc": 0.8806050419807434, "length": 4.0, "mode": "test", "epoch": 11}
{"loss": 0.22266614437103271, "acc": 0.906910240650177, "length": 3.9067447185516357, "mode": "train", "epoch": 12}
{"loss": 0.2957911789417267, "acc": 0.895907461643219, "length": 4.0, "mode": "test", "epoch": 12}
{"loss": 0.20032115280628204, "acc": 0.9220021367073059, "length": 3.9523770809173584, "mode": "train", "epoch": 13}
{"loss": 0.2554735839366913, "acc": 0.9064058661460876, "length": 4.0, "mode": "test", "epoch": 13}
{"loss": 0.18498623371124268, "acc": 0.9268842339515686, "length": 3.965137004852295, "mode": "train", "epoch": 14}
{"loss": 0.2455947995185852, "acc": 0.9097864627838135, "length": 4.0, "mode": "test", "epoch": 14}
{"loss": 0.1723223477602005, "acc": 0.9375677108764648, "length": 3.9780800342559814, "mode": "train", "epoch": 15}
{"loss": 0.23908554017543793, "acc": 0.9154803156852722, "length": 4.0, "mode": "test", "epoch": 15}
{"loss": 0.1697179526090622, "acc": 0.9378395080566406, "length": 3.9809179306030273, "mode": "train", "epoch": 16}
{"loss": 0.24681851267814636, "acc": 0.9167261123657227, "length": 4.0, "mode": "test", "epoch": 16}
{"loss": 0.15462391078472137, "acc": 0.9413201212882996, "length": 3.98828387260437, "mode": "train", "epoch": 17}
{"loss": 0.2112317830324173, "acc": 0.9258008003234863, "length": 4.0, "mode": "test", "epoch": 17}
{"loss": 0.16518208384513855, "acc": 0.9397676587104797, "length": 3.992100477218628, "mode": "train", "epoch": 18}
{"loss": 0.23382626473903656, "acc": 0.9112101197242737, "length": 4.0, "mode": "test", "epoch": 18}
{"loss": 0.14988945424556732, "acc": 0.9466249346733093, "length": 3.9923508167266846, "mode": "train", "epoch": 19}
{"loss": 0.18223510682582855, "acc": 0.9382562041282654, "length": 4.0, "mode": "test", "epoch": 19}
{"loss": 0.1387028843164444, "acc": 0.9483916163444519, "length": 3.9914817810058594, "mode": "train", "epoch": 20}
{"loss": 0.1776384711265564, "acc": 0.945195734500885, "length": 4.0, "mode": "test", "epoch": 20}
{"loss": 0.13895635306835175, "acc": 0.9488308429718018, "length": 3.9954335689544678, "mode": "train", "epoch": 21}
{"loss": 0.17035412788391113, "acc": 0.9414591193199158, "length": 4.0, "mode": "test", "epoch": 21}
{"loss": 0.13635459542274475, "acc": 0.9507872462272644, "length": 3.9974019527435303, "mode": "train", "epoch": 22}
{"loss": 0.17593462765216827, "acc": 0.9341638088226318, "length": 4.0, "mode": "test", "epoch": 22}
{"loss": 0.12784408032894135, "acc": 0.9555243849754333, "length": 3.9937100410461426, "mode": "train", "epoch": 23}
{"loss": 0.1691800355911255, "acc": 0.940391480922699, "length": 4.0, "mode": "test", "epoch": 23}
{"loss": 0.13195586204528809, "acc": 0.9517053365707397, "length": 3.9979453086853027, "mode": "train", "epoch": 24}
{"loss": 0.1547674536705017, "acc": 0.9492882490158081, "length": 4.0, "mode": "test", "epoch": 24}
{"loss": 0.12681636214256287, "acc": 0.9534093141555786, "length": 3.997042417526245, "mode": "train", "epoch": 25}
{"loss": 0.14561371505260468, "acc": 0.9485766887664795, "length": 4.0, "mode": "test", "epoch": 25}
{"loss": 0.11654195934534073, "acc": 0.9580177664756775, "length": 3.998080015182495, "mode": "train", "epoch": 26}
{"loss": 0.13734795153141022, "acc": 0.9485765695571899, "length": 4.0, "mode": "test", "epoch": 26}
{"loss": 0.1120079904794693, "acc": 0.9593719244003296, "length": 3.9971489906311035, "mode": "train", "epoch": 27}
{"loss": 0.16004793345928192, "acc": 0.9386122226715088, "length": 4.0, "mode": "test", "epoch": 27}
{"loss": 0.10897959023714066, "acc": 0.9596193432807922, "length": 3.9982292652130127, "mode": "train", "epoch": 28}
{"loss": 0.15307487547397614, "acc": 0.9386121034622192, "length": 4.0, "mode": "test", "epoch": 28}
{"loss": 0.11857705563306808, "acc": 0.9579854607582092, "length": 3.9973158836364746, "mode": "train", "epoch": 29}
{"loss": 0.17043475806713104, "acc": 0.9459075331687927, "length": 4.0, "mode": "test", "epoch": 29}
{"loss": 0.10295280069112778, "acc": 0.9622097611427307, "length": 3.9990310668945312, "mode": "train", "epoch": 30}
{"loss": 0.1488148421049118, "acc": 0.9508897066116333, "length": 4.0, "mode": "test", "epoch": 30}
{"loss": 0.10231885313987732, "acc": 0.9651772379875183, "length": 3.998335361480713, "mode": "train", "epoch": 31}
{"loss": 0.15351562201976776, "acc": 0.9476869106292725, "length": 4.0, "mode": "test", "epoch": 31}
{"loss": 0.10902022570371628, "acc": 0.9604585766792297, "length": 3.998805522918701, "mode": "train", "epoch": 32}
{"loss": 0.15564873814582825, "acc": 0.9532028436660767, "length": 4.0, "mode": "test", "epoch": 32}
{"loss": 0.10276627540588379, "acc": 0.9665600657463074, "length": 3.999498128890991, "mode": "train", "epoch": 33}
{"loss": 0.14906269311904907, "acc": 0.9501780271530151, "length": 4.0, "mode": "test", "epoch": 33}
{"loss": 0.10958124697208405, "acc": 0.9600031971931458, "length": 3.9993255138397217, "mode": "train", "epoch": 34}
{"loss": 0.16306130588054657, "acc": 0.9457294344902039, "length": 4.0, "mode": "test", "epoch": 34}
{"loss": 0.11833862215280533, "acc": 0.9589958786964417, "length": 3.9998602867126465, "mode": "train", "epoch": 35}
{"loss": 0.17794300615787506, "acc": 0.9430603981018066, "length": 4.0, "mode": "test", "epoch": 35}
{"loss": 0.10596127808094025, "acc": 0.9629572629928589, "length": 3.998971700668335, "mode": "train", "epoch": 36}
{"loss": 0.1389191895723343, "acc": 0.9540925621986389, "length": 4.0, "mode": "test", "epoch": 36}
{"loss": 0.09765058010816574, "acc": 0.967162549495697, "length": 3.996335744857788, "mode": "train", "epoch": 37}
{"loss": 0.15282446146011353, "acc": 0.9540924429893494, "length": 4.0, "mode": "test", "epoch": 37}
{"loss": 0.10432986915111542, "acc": 0.9633907079696655, "length": 3.9985458850860596, "mode": "train", "epoch": 38}
{"loss": 0.15289312601089478, "acc": 0.9517794251441956, "length": 4.0, "mode": "test", "epoch": 38}
{"loss": 0.08431978523731232, "acc": 0.9710868000984192, "length": 3.998192310333252, "mode": "train", "epoch": 39}
{"loss": 0.11649738252162933, "acc": 0.9594307541847229, "length": 4.0, "mode": "test", "epoch": 39}
{"loss": 0.08315768837928772, "acc": 0.9703682065010071, "length": 3.998676061630249, "mode": "train", "epoch": 40}
{"loss": 0.12672217190265656, "acc": 0.9592528343200684, "length": 4.0, "mode": "test", "epoch": 40}
{"loss": 0.08367198705673218, "acc": 0.9715678095817566, "length": 3.9997527599334717, "mode": "train", "epoch": 41}
{"loss": 0.1281459480524063, "acc": 0.9603202939033508, "length": 4.0, "mode": "test", "epoch": 41}
{"loss": 0.08137816935777664, "acc": 0.9727649092674255, "length": 3.9999797344207764, "mode": "train", "epoch": 42}
{"loss": 0.1198330968618393, "acc": 0.9606761932373047, "length": 4.0, "mode": "test", "epoch": 42}
{"loss": 0.10676366090774536, "acc": 0.9668253064155579, "length": 3.998493194580078, "mode": "train", "epoch": 43}
{"loss": 0.12214811891317368, "acc": 0.9594306349754333, "length": 4.0, "mode": "test", "epoch": 43}
{"loss": 0.0915495976805687, "acc": 0.9643056392669678, "length": 3.997607469558716, "mode": "train", "epoch": 44}
{"loss": 0.12208357453346252, "acc": 0.959964394569397, "length": 4.0, "mode": "test", "epoch": 44}
{"loss": 0.081650011241436, "acc": 0.9703148603439331, "length": 3.999567985534668, "mode": "train", "epoch": 45}
{"loss": 0.10476143658161163, "acc": 0.9633453488349915, "length": 4.0, "mode": "test", "epoch": 45}
{"loss": 0.06896349042654037, "acc": 0.9757441878318787, "length": 3.9999184608459473, "mode": "train", "epoch": 46}
{"loss": 0.10277855396270752, "acc": 0.9583630561828613, "length": 4.0, "mode": "test", "epoch": 46}
{"loss": 0.07092219591140747, "acc": 0.9770538806915283, "length": 3.999884843826294, "mode": "train", "epoch": 47}
{"loss": 0.0991121456027031, "acc": 0.961921751499176, "length": 4.0, "mode": "test", "epoch": 47}
{"loss": 0.07765987515449524, "acc": 0.9731764793395996, "length": 3.999572277069092, "mode": "train", "epoch": 48}
{"loss": 0.11250713467597961, "acc": 0.9656583666801453, "length": 4.0, "mode": "test", "epoch": 48}
{"loss": 0.08088689297437668, "acc": 0.9737087488174438, "length": 3.999091148376465, "mode": "train", "epoch": 49}
{"loss": 0.12887507677078247, "acc": 0.9590747356414795, "length": 4.0, "mode": "test", "epoch": 49}
{"loss": 0.07110639661550522, "acc": 0.9787195920944214, "length": 3.9996418952941895, "mode": "train", "epoch": 50}
{"loss": 0.09258326143026352, "acc": 0.9653027057647705, "length": 4.0, "mode": "test", "epoch": 50}
{"loss": 0.06581421196460724, "acc": 0.9777109026908875, "length": 3.9999639987945557, "mode": "train", "epoch": 51}
{"loss": 0.09303847700357437, "acc": 0.9665480852127075, "length": 4.0, "mode": "test", "epoch": 51}
{"loss": 0.0599067248404026, "acc": 0.9772936105728149, "length": 3.9999005794525146, "mode": "train", "epoch": 52}
{"loss": 0.0909585952758789, "acc": 0.9672597646713257, "length": 4.0, "mode": "test", "epoch": 52}
{"loss": 0.06325682252645493, "acc": 0.976041853427887, "length": 3.9999136924743652, "mode": "train", "epoch": 53}
{"loss": 0.09539758414030075, "acc": 0.9686833024024963, "length": 4.0, "mode": "test", "epoch": 53}
{"loss": 0.06295682489871979, "acc": 0.9799102544784546, "length": 3.999676465988159, "mode": "train", "epoch": 54}
{"loss": 0.09133372455835342, "acc": 0.9645907282829285, "length": 4.0, "mode": "test", "epoch": 54}
{"loss": 0.0589984692633152, "acc": 0.9784756302833557, "length": 3.9991135597229004, "mode": "train", "epoch": 55}
{"loss": 0.12664659321308136, "acc": 0.9601424336433411, "length": 4.0, "mode": "test", "epoch": 55}
{"loss": 0.07621379941701889, "acc": 0.9730007648468018, "length": 3.9998371601104736, "mode": "train", "epoch": 56}
{"loss": 0.09786957502365112, "acc": 0.9692172408103943, "length": 4.0, "mode": "test", "epoch": 56}
{"loss": 0.05943284556269646, "acc": 0.97850501537323, "length": 3.996983051300049, "mode": "train", "epoch": 57}
{"loss": 0.09807901084423065, "acc": 0.965480387210846, "length": 4.0, "mode": "test", "epoch": 57}
{"loss": 0.05202977731823921, "acc": 0.9819958806037903, "length": 3.9989466667175293, "mode": "train", "epoch": 58}
{"loss": 0.08571784943342209, "acc": 0.9660141468048096, "length": 4.0, "mode": "test", "epoch": 58}
{"loss": 0.05035948008298874, "acc": 0.9816907644271851, "length": 3.9991562366485596, "mode": "train", "epoch": 59}
{"loss": 0.08495471626520157, "acc": 0.9725979566574097, "length": 4.0, "mode": "test", "epoch": 59}
{"loss": 0.05722014978528023, "acc": 0.9795420169830322, "length": 3.9994735717773438, "mode": "train", "epoch": 60}
{"loss": 0.09439156949520111, "acc": 0.9642348289489746, "length": 4.0, "mode": "test", "epoch": 60}
test accuracy: 0.8165625333786011
