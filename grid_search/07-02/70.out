# ["--attributes=5", "--values=4", "--game_size=10", "--vocab_size_factor=3", "--n_epochs=60", "--batch_size=128", "--learning_rate=0.001", "--hidden_size=256", "--temp_update=0.97", "--temperature=1.5"]
Creating train_ds and val_ds...

Creating test_ds...
{"loss": 0.7088920474052429, "acc": 0.5155666470527649, "length": 3.3340747356414795, "mode": "train", "epoch": 1}
{"loss": 0.7022064924240112, "acc": 0.4904513955116272, "length": 1.0, "mode": "test", "epoch": 1}
{"loss": 0.6960781216621399, "acc": 0.5121018290519714, "length": 1.7262316942214966, "mode": "train", "epoch": 2}
{"loss": 0.6899530291557312, "acc": 0.5357639193534851, "length": 1.0, "mode": "test", "epoch": 2}
{"loss": 0.6828604936599731, "acc": 0.5573559403419495, "length": 1.565197467803955, "mode": "train", "epoch": 3}
{"loss": 0.6681685447692871, "acc": 0.6001002788543701, "length": 1.1770833730697632, "mode": "test", "epoch": 3}
{"loss": 0.6433168649673462, "acc": 0.6556008458137512, "length": 2.353196144104004, "mode": "train", "epoch": 4}
{"loss": 0.6005966067314148, "acc": 0.7402507066726685, "length": 2.1423611640930176, "mode": "test", "epoch": 4}
{"loss": 0.5642678141593933, "acc": 0.7458194494247437, "length": 2.683716058731079, "mode": "train", "epoch": 5}
{"loss": 0.523433268070221, "acc": 0.7654893398284912, "length": 3.21875, "mode": "test", "epoch": 5}
{"loss": 0.47442254424095154, "acc": 0.7890806198120117, "length": 3.436711311340332, "mode": "train", "epoch": 6}
{"loss": 0.4756682813167572, "acc": 0.7916151285171509, "length": 3.784722328186035, "mode": "test", "epoch": 6}
{"loss": 0.4238913953304291, "acc": 0.8170128464698792, "length": 3.6545138359069824, "mode": "train", "epoch": 7}
{"loss": 0.4491613507270813, "acc": 0.8335394263267517, "length": 3.4895832538604736, "mode": "test", "epoch": 7}
{"loss": 0.3771893084049225, "acc": 0.8436278104782104, "length": 3.4125752449035645, "mode": "train", "epoch": 8}
{"loss": 0.4357360005378723, "acc": 0.8362168669700623, "length": 3.6354167461395264, "mode": "test", "epoch": 8}
{"loss": 0.3570907711982727, "acc": 0.8536068797111511, "length": 3.5216450691223145, "mode": "train", "epoch": 9}
{"loss": 0.44213685393333435, "acc": 0.8374579548835754, "length": 3.694444417953491, "mode": "test", "epoch": 9}
{"loss": 0.34646880626678467, "acc": 0.8582790493965149, "length": 3.5484390258789062, "mode": "train", "epoch": 10}
{"loss": 0.4213833808898926, "acc": 0.832175076007843, "length": 3.628472328186035, "mode": "test", "epoch": 10}
{"loss": 0.3382037580013275, "acc": 0.8601487874984741, "length": 3.5487420558929443, "mode": "train", "epoch": 11}
{"loss": 0.38889607787132263, "acc": 0.8463664650917053, "length": 3.565972328186035, "mode": "test", "epoch": 11}
{"loss": 0.32368001341819763, "acc": 0.8680084943771362, "length": 3.524475336074829, "mode": "train", "epoch": 12}
{"loss": 0.35688549280166626, "acc": 0.8495455980300903, "length": 3.621527671813965, "mode": "test", "epoch": 12}
{"loss": 0.3110336661338806, "acc": 0.8750320672988892, "length": 3.640930414199829, "mode": "train", "epoch": 13}
{"loss": 0.3481643795967102, "acc": 0.8535060286521912, "length": 3.7361111640930176, "mode": "test", "epoch": 13}
{"loss": 0.3011285662651062, "acc": 0.8771046996116638, "length": 3.6611487865448, "mode": "train", "epoch": 14}
{"loss": 0.34846222400665283, "acc": 0.8484104871749878, "length": 3.722222328186035, "mode": "test", "epoch": 14}
{"loss": 0.28916001319885254, "acc": 0.8811851143836975, "length": 3.6463592052459717, "mode": "train", "epoch": 15}
{"loss": 0.33424729108810425, "acc": 0.8542277812957764, "length": 3.6111111640930176, "mode": "test", "epoch": 15}
{"loss": 0.2806156277656555, "acc": 0.8803214430809021, "length": 3.683708429336548, "mode": "train", "epoch": 16}
{"loss": 0.3273484706878662, "acc": 0.8516221046447754, "length": 3.746527671813965, "mode": "test", "epoch": 16}
{"loss": 0.2715693712234497, "acc": 0.886398196220398, "length": 3.6780447959899902, "mode": "train", "epoch": 17}
{"loss": 0.3076147437095642, "acc": 0.8709580898284912, "length": 3.6701388359069824, "mode": "test", "epoch": 17}
{"loss": 0.2662088871002197, "acc": 0.8908721804618835, "length": 3.6657187938690186, "mode": "train", "epoch": 18}
{"loss": 0.3007093071937561, "acc": 0.8776882290840149, "length": 3.753472328186035, "mode": "test", "epoch": 18}
{"loss": 0.2507653534412384, "acc": 0.8941197395324707, "length": 3.6935203075408936, "mode": "train", "epoch": 19}
{"loss": 0.2831791341304779, "acc": 0.8835326433181763, "length": 3.809027671813965, "mode": "test", "epoch": 19}
{"loss": 0.2438560277223587, "acc": 0.9030461311340332, "length": 3.674021005630493, "mode": "train", "epoch": 20}
{"loss": 0.27350902557373047, "acc": 0.8894164562225342, "length": 3.722222328186035, "mode": "test", "epoch": 20}
{"loss": 0.23385216295719147, "acc": 0.9060165286064148, "length": 3.6516635417938232, "mode": "train", "epoch": 21}
{"loss": 0.28013116121292114, "acc": 0.8868327140808105, "length": 3.7326388359069824, "mode": "test", "epoch": 21}
{"loss": 0.22709517180919647, "acc": 0.9096720218658447, "length": 3.6714727878570557, "mode": "train", "epoch": 22}
{"loss": 0.2593270540237427, "acc": 0.896824836730957, "length": 3.7048611640930176, "mode": "test", "epoch": 22}
{"loss": 0.22328561544418335, "acc": 0.907968282699585, "length": 3.6407291889190674, "mode": "train", "epoch": 23}
{"loss": 0.2529250979423523, "acc": 0.9011393785476685, "length": 3.663194417953491, "mode": "test", "epoch": 23}
{"loss": 0.2184203416109085, "acc": 0.9134013652801514, "length": 3.5924839973449707, "mode": "train", "epoch": 24}
{"loss": 0.260798841714859, "acc": 0.9038642048835754, "length": 3.6736111640930176, "mode": "test", "epoch": 24}
{"loss": 0.2142896205186844, "acc": 0.917087733745575, "length": 3.66106915473938, "mode": "train", "epoch": 25}
{"loss": 0.2632303237915039, "acc": 0.9059529900550842, "length": 3.6770832538604736, "mode": "test", "epoch": 25}
{"loss": 0.20316798985004425, "acc": 0.9206909537315369, "length": 3.673647165298462, "mode": "train", "epoch": 26}
{"loss": 0.2540814280509949, "acc": 0.9017429351806641, "length": 3.7048611640930176, "mode": "test", "epoch": 26}
{"loss": 0.2028089016675949, "acc": 0.9187794327735901, "length": 3.644306182861328, "mode": "train", "epoch": 27}
{"loss": 0.23593363165855408, "acc": 0.9104804992675781, "length": 3.7083332538604736, "mode": "test", "epoch": 27}
{"loss": 0.19560469686985016, "acc": 0.924008846282959, "length": 3.672208547592163, "mode": "train", "epoch": 28}
{"loss": 0.2237318456172943, "acc": 0.9165337085723877, "length": 3.65625, "mode": "test", "epoch": 28}
{"loss": 0.19566331803798676, "acc": 0.9224146604537964, "length": 3.658571243286133, "mode": "train", "epoch": 29}
{"loss": 0.22051531076431274, "acc": 0.9225992560386658, "length": 3.7048611640930176, "mode": "test", "epoch": 29}
{"loss": 0.18917341530323029, "acc": 0.9285041689872742, "length": 3.6773455142974854, "mode": "train", "epoch": 30}
{"loss": 0.21084222197532654, "acc": 0.9125989079475403, "length": 3.6388888359069824, "mode": "test", "epoch": 30}
{"loss": 0.18961264193058014, "acc": 0.9254010319709778, "length": 3.585113286972046, "mode": "train", "epoch": 31}
{"loss": 0.21509066224098206, "acc": 0.922379732131958, "length": 3.631944417953491, "mode": "test", "epoch": 31}
{"loss": 0.1913149058818817, "acc": 0.9273234009742737, "length": 3.6297128200531006, "mode": "train", "epoch": 32}
{"loss": 0.22118958830833435, "acc": 0.9197523593902588, "length": 3.618055582046509, "mode": "test", "epoch": 32}
{"loss": 0.1840699464082718, "acc": 0.9329156279563904, "length": 3.6338536739349365, "mode": "train", "epoch": 33}
{"loss": 0.2059633433818817, "acc": 0.9250081181526184, "length": 3.625, "mode": "test", "epoch": 33}
{"loss": 0.18546946346759796, "acc": 0.9293169975280762, "length": 3.6429309844970703, "mode": "train", "epoch": 34}
{"loss": 0.2216164767742157, "acc": 0.9186848402023315, "length": 3.7013888359069824, "mode": "test", "epoch": 34}
{"loss": 0.1833241581916809, "acc": 0.9297826886177063, "length": 3.616678476333618, "mode": "train", "epoch": 35}
{"loss": 0.22669082880020142, "acc": 0.9237305521965027, "length": 3.631944417953491, "mode": "test", "epoch": 35}
{"loss": 0.17867065966129303, "acc": 0.9342564344406128, "length": 3.624260425567627, "mode": "train", "epoch": 36}
{"loss": 0.20285531878471375, "acc": 0.9302150011062622, "length": 3.6423611640930176, "mode": "test", "epoch": 36}
{"loss": 0.1672118455171585, "acc": 0.9352666735649109, "length": 3.6161491870880127, "mode": "train", "epoch": 37}
{"loss": 0.20279207825660706, "acc": 0.9324204921722412, "length": 3.625, "mode": "test", "epoch": 37}
{"loss": 0.16121111810207367, "acc": 0.9395660758018494, "length": 3.6261041164398193, "mode": "train", "epoch": 38}
{"loss": 0.2048579305410385, "acc": 0.9303520917892456, "length": 3.6736111640930176, "mode": "test", "epoch": 38}
{"loss": 0.16140908002853394, "acc": 0.9399877190589905, "length": 3.6125056743621826, "mode": "train", "epoch": 39}
{"loss": 0.18446306884288788, "acc": 0.9311196804046631, "length": 3.621527671813965, "mode": "test", "epoch": 39}
{"loss": 0.1675744354724884, "acc": 0.9376864433288574, "length": 3.6045286655426025, "mode": "train", "epoch": 40}
{"loss": 0.20759814977645874, "acc": 0.9195639491081238, "length": 3.631944417953491, "mode": "test", "epoch": 40}
{"loss": 0.1598472148180008, "acc": 0.9399200677871704, "length": 3.603663444519043, "mode": "train", "epoch": 41}
{"loss": 0.21181327104568481, "acc": 0.929375410079956, "length": 3.680555582046509, "mode": "test", "epoch": 41}
{"loss": 0.15517441928386688, "acc": 0.9413614869117737, "length": 3.6225483417510986, "mode": "train", "epoch": 42}
{"loss": 0.1924172043800354, "acc": 0.9347764253616333, "length": 3.6076388359069824, "mode": "test", "epoch": 42}
{"loss": 0.16102340817451477, "acc": 0.9389360547065735, "length": 3.616851806640625, "mode": "train", "epoch": 43}
{"loss": 0.19841307401657104, "acc": 0.9312309622764587, "length": 3.6701388359069824, "mode": "test", "epoch": 43}
{"loss": 0.15484434366226196, "acc": 0.939677894115448, "length": 3.611210823059082, "mode": "train", "epoch": 44}
{"loss": 0.20526203513145447, "acc": 0.9272176027297974, "length": 3.6076388359069824, "mode": "test", "epoch": 44}
{"loss": 0.1543121039867401, "acc": 0.943562388420105, "length": 3.637545585632324, "mode": "train", "epoch": 45}
{"loss": 0.18689009547233582, "acc": 0.9345526099205017, "length": 3.600694417953491, "mode": "test", "epoch": 45}
{"loss": 0.14990456402301788, "acc": 0.944355309009552, "length": 3.619107961654663, "mode": "train", "epoch": 46}
{"loss": 0.21482257544994354, "acc": 0.9323242902755737, "length": 3.694444417953491, "mode": "test", "epoch": 46}
{"loss": 0.14372506737709045, "acc": 0.9448268413543701, "length": 3.606786012649536, "mode": "train", "epoch": 47}
{"loss": 0.1733931005001068, "acc": 0.9391656517982483, "length": 3.621527671813965, "mode": "test", "epoch": 47}
{"loss": 0.14348557591438293, "acc": 0.9467343688011169, "length": 3.6281747817993164, "mode": "train", "epoch": 48}
{"loss": 0.1823468804359436, "acc": 0.9357693791389465, "length": 3.6458332538604736, "mode": "test", "epoch": 48}
{"loss": 0.14376536011695862, "acc": 0.947072446346283, "length": 3.624051094055176, "mode": "train", "epoch": 49}
{"loss": 0.1782570481300354, "acc": 0.9400119781494141, "length": 3.649305582046509, "mode": "test", "epoch": 49}
{"loss": 0.14215156435966492, "acc": 0.9447660446166992, "length": 3.6341166496276855, "mode": "train", "epoch": 50}
{"loss": 0.17411260306835175, "acc": 0.9385931491851807, "length": 3.663194417953491, "mode": "test", "epoch": 50}
{"loss": 0.13792477548122406, "acc": 0.9454056620597839, "length": 3.6410741806030273, "mode": "train", "epoch": 51}
{"loss": 0.1820049285888672, "acc": 0.9359768629074097, "length": 3.659722328186035, "mode": "test", "epoch": 51}
{"loss": 0.14060978591442108, "acc": 0.9416474103927612, "length": 3.64609956741333, "mode": "train", "epoch": 52}
{"loss": 0.1846771538257599, "acc": 0.9355522990226746, "length": 3.6423611640930176, "mode": "test", "epoch": 52}
{"loss": 0.13897661864757538, "acc": 0.947335422039032, "length": 3.6419336795806885, "mode": "train", "epoch": 53}
{"loss": 0.159364253282547, "acc": 0.9401583075523376, "length": 3.6875, "mode": "test", "epoch": 53}
{"loss": 0.13512323796749115, "acc": 0.9460946917533875, "length": 3.637362241744995, "mode": "train", "epoch": 54}
{"loss": 0.2063879817724228, "acc": 0.9310939311981201, "length": 3.631944417953491, "mode": "test", "epoch": 54}
{"loss": 0.14142218232154846, "acc": 0.9441282153129578, "length": 3.6553094387054443, "mode": "train", "epoch": 55}
{"loss": 0.20355205237865448, "acc": 0.941868782043457, "length": 3.6701388359069824, "mode": "test", "epoch": 55}
{"loss": 0.14257441461086273, "acc": 0.9469935297966003, "length": 3.635693073272705, "mode": "train", "epoch": 56}
{"loss": 0.20393413305282593, "acc": 0.9295709133148193, "length": 3.715277671813965, "mode": "test", "epoch": 56}
{"loss": 0.14880631864070892, "acc": 0.9438321590423584, "length": 3.667858123779297, "mode": "train", "epoch": 57}
{"loss": 0.18973790109157562, "acc": 0.9261149168014526, "length": 3.6701388359069824, "mode": "test", "epoch": 57}
{"loss": 0.13691984117031097, "acc": 0.945228099822998, "length": 3.629396438598633, "mode": "train", "epoch": 58}
{"loss": 0.19136792421340942, "acc": 0.9339816570281982, "length": 3.6388888359069824, "mode": "test", "epoch": 58}
{"loss": 0.13096944987773895, "acc": 0.9502688646316528, "length": 3.631470203399658, "mode": "train", "epoch": 59}
{"loss": 0.18658769130706787, "acc": 0.9394503831863403, "length": 3.6770832538604736, "mode": "test", "epoch": 59}
{"loss": 0.14308330416679382, "acc": 0.9440416693687439, "length": 3.6447081565856934, "mode": "train", "epoch": 60}
{"loss": 0.1957799196243286, "acc": 0.941655695438385, "length": 3.6701388359069824, "mode": "test", "epoch": 60}
test accuracy: 0.8308722972869873
